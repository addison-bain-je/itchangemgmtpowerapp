"Scn_RequestForm As screen.'tabletAutoLayout_HeaderMainFooter_ver1.0'":
    Fill: |
        =RGBA(237, 237, 237, 1)
    OnVisible: |-
        =//Set to lock record by default
        UpdateContext({ConVar_UnlockRecord: false});
        
        //Set default entry tab based on stage code
        Switch(SelectedCR.StageCode,
        "1", Set(RequestNavBar, "ContainerRequestDetails"),
        "2", Set(RequestNavBar, "ContainerRequestDetails"),
        "3", Set(RequestNavBar, "ContainerInfoSec"),
        "4", Set(RequestNavBar, "ContainerCABApprovals"),
        "5", Set(RequestNavBar, "ContainerCABApprovals"),
        "6", Set(RequestNavBar, "ContainerImplementationPlan"),
        "7", Set(RequestNavBar, "ContainerImplementationPlan"),
        "8", Set(RequestNavBar, "ContainerImplementationPlan"),
        Set(RequestNavBar, "ContainerRequestDetails"));
        
        //Refresh CAB collection
        If(!IsBlank(ComboBox_CABGroup_Select.SelectedItems) And Dropdown_Category.Selected.CategoryName<>"Emergency",
                ClearCollect(ColTempCABMembers, Filter(ITAccountsList, GroupAssignment.Value=ComboBox_CABGroup_Select.Selected.GroupName));
                ClearCollect(ColTempCABMembersUnique, Distinct(ColTempCABMembers,ITAcctEmail)));
        
        //Refresh E-CAB Collection
        If(Dropdown_Category.Selected.CategoryName="Emergency" And IsBlank(SelectedCR.ECABMembers),
            Clear(ColTempECAB),
                If(Dropdown_Category.Selected.CategoryName="Emergency" And !IsBlank(SelectedCR.ECABMembers),
                    Clear(ColTempECAB);
                    ForAll(
                        Split(
                            SelectedCR.ECABMembers,"; "),
                        Collect(ColTempECAB, TrimEnds(ThisRecord.Value))
                    )));
        
        
        //Set ReAssign Variables to false
        Set(VarReassignIS, false);
        Set(VarReassignAGM, false);
        Set(VarReassignCAB, false);
        Set(VarReassignCM, false);
        Set(VarReassignReviewer, false);

    Lbl_AppVersion_Request As label:
        Height: =23
        PaddingLeft: =15
        Size: =7
        Text: =""&LookUp(ConfigGenParam,Title="AppVersion",ParamValue)
        Width: =100
        Y: =745
        ZIndex: =1

    Container_CAB As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =221
        Visible: =If(Rect_CABApprovals.Visible,true,false)
        Width: =1297
        X: =38
        Y: =522
        ZIndex: =3

        TextInput_CABRemarks As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =If(IsBlank(SelectedCR.CABReviewerRemarks),Blank(),SelectedCR.CABReviewerRemarks)
            DisplayMode: |-
                =//DisplayMode.Edit
                If(Value(SelectedCR.StageCode)=4  And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =167
            HintText: ="Assess change request for technical and business risk"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: =
            Width: =508
            X: =745
            Y: =40
            ZIndex: =4

        Lbl_CABRemarks As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |-
                =//"CAB Remarks  *"
                If(Value(SelectedCR.StageCode)>=4 And Value(SelectedCR.StageCode)<=8, "CAB Remarks  *", "CAB Remarks")
            Width: =282
            X: =743
            Y: =11
            ZIndex: =8

        Lbl_CABGrp_Hdr As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |-
                =//"Select Change Advisory Board"
                If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<=8, "Select Change Advisory Board  *", "Select Change Advisory Board")
            Visible: |-
                =//true
                If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="4") And Dropdown_Category.Selected.CategoryName<>"Emergency",true,false)
            Width: =220
            X: =34
            Y: =11
            ZIndex: =9

        ComboBox_CABGroup_Select As combobox:
            BorderColor: =RGBA(255, 125, 35, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: |-
                =If(Dropdown_Category.Selected.CategoryName="Major" Or Dropdown_Category.Selected.CategoryName="Emergency", Blank(),
                    If(IsBlank(SelectedCR.CABGroupAssigned),Blank(),
                        LookUp(ColGroups,GroupName=SelectedCR.CABGroupAssigned)))
            DefaultSelectedItems: |-
                =If(IsBlank(SelectedCR.CABGroupAssigned) Or Dropdown_Category.Selected.CategoryName="Major" Or Dropdown_Category.Selected.CategoryName="Emergency",Blank(),
                    If(SelectedCR.CABGroupAssigned="E-CAB",Blank(),
                                LookUp(ColGroups,GroupName=SelectedCR.CABGroupAssigned)))
            DisplayFields: =["GroupName","Mail"]
            DisplayMode: |-
                =//Editable only if at stages 2 - 4, else Disabled
                If((SelectedCR.StageCode="2" Or SelectedCR.StageCode = "3" Or SelectedCR.StageCode = "4" And UpdateFormMode="Edit") Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            Height: =28
            HoverFill: =RGBA(253, 222, 207, 1)
            InputTextPlaceholder: ="Find group"
            IsSearchable: =false
            Items: =Filter(ColGroups, CABFlag="Y").GroupName
            OnChange: |-
                =If(SelectedCR.StatusCode="401" And (SelectedCR.CABGroupAssigned <> ComboBox_CABGroup_Select.Selected.GroupName And !IsBlank(SelectedCR.CABGroupAssigned) And !IsBlank(ComboBox_CABGroup_Select.Selected.GroupName)), 
                Set(VarReassignCAB, true), Set(VarReassignCAB, false));
            OnSelect: |-
                =ClearCollect(ColTempCABMembers, Filter(ITAccountsList, GroupAssignment.Value=ComboBox_CABGroup_Select.Selected.GroupName));
                ClearCollect(ColTempCABMembersUnique, Distinct(ColTempCABMembers,ITAcctEmail));
            PaddingBottom: =3
            PaddingLeft: =3
            PaddingRight: =3
            PaddingTop: =3
            PressedFill: =RGBA(253, 222, 207, 1)
            SearchFields: =["GroupName"]
            SearchItems: =[]
            SelectionFill: =RGBA(250, 155, 112, 1)
            SelectMultiple: =false
            Size: =9
            Visible: |-
                =//true
                If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="4") And Dropdown_Category.Selected.CategoryName<>"Emergency",true,false)
            Width: =210
            X: =37
            Y: =42
            ZIndex: =12

        Gal_DisplayCABSelection As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderColor: =RGBA(246, 88, 16, 1)
            BorderThickness: =1
            DelayItemLoading: =true
            DisplayMode: |-
                =DisplayMode.Edit
                //If(Value(SelectedCR.StageCode)=4, DisplayMode.Edit, DisplayMode.Edit)
            Height: =169
            Items: =If(Dropdown_Category.Selected.CategoryName="Emergency",ColTempECAB, ColTempCABMembersUnique)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =35
            Visible: |-
                =If( Dropdown_Category.Selected.CategoryName<>"Emergency" And ((SelectedCR.CABGroup=ComboBox_CABGroup_Select.Selected.GroupName) Or (CountRows(ColTempCABMembersUnique)>0)),true,
                     Dropdown_Category.Selected.CategoryName="Emergency" And (CountRows(ColTempECAB)>0),true,false)
            Width: =439
            X: =286
            Y: =38
            ZIndex: =18

            Lbl_CABSelectEmail As label:
                Height: =13
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =7
                Text: =ThisItem.Value
                Width: =187
                X: =37
                Y: =18
                ZIndex: =2

            Lbl_CABSelectName As label:
                FontWeight: =FontWeight.Semibold
                Height: =15
                OnSelect: =Select(Parent)
                Size: =8
                Text: |-
                    =If(!IsBlank(ThisItem.Value), 
                        IfError(Office365Users.UserProfileV2(ThisItem.Value),Blank(),
                            Office365Users.UserProfileV2(ThisItem.Value).displayName))
                Width: =172
                X: =39
                Y: =4
                ZIndex: =3

            Lbl_CABApprovalStatus As label:
                Align: =Align.Right
                Height: =20
                Size: =8
                Text: |-
                    =If(ThisItem.Value = SelectedCR.RequesterEmail Or ThisItem.Value = SelectedCR.ChangeManagerEmail , "Not Eligible for CAB",
                        If(IsBlank(SelectedCR.CABReviewerEmail),"Pending",
                            If(Lower(ThisItem.Value)=Lower(SelectedCR.CABReviewerEmail), SelectedCR.CABReviewerOutcome & " on " & SelectedCR.CABResponseDate
                            ,"")
                    ))
                Width: =199
                X: =222
                Y: =8
                ZIndex: =9

            Icon2 As icon.Blocked:
                Color: =RGBA(168, 0, 0, 1)
                Height: =14
                Icon: =Icon.Blocked
                OnSelect: |-
                    =RemoveIf(
                        ColTempECAB, ThisRecord.Value=ThisItem.Value);
                Visible: =If(Dropdown_Category.Selected.CategoryName="Emergency" And (CountRows(ColTempECAB)>0) And (SelectedCR.StageCode="2"),true,false)
                Width: =37
                Y: =11
                ZIndex: =10

        Lbl_CABGrp_Gal_Hdr As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |
                =Switch(Dropdown_Category.Selected.CategoryName,
                "Emergency",
                If(SelectedCR.StageCode="2","E-CAB Members","E-CAB Review (First to Approve / Reject)"),
                If(SelectedCR.StageCode="2","CAB Members","CAB Review (First to Approve / Reject)"))
            Width: =282
            X: =286
            Y: =9
            ZIndex: =19

        Lbl_ECAB_SelectPerson As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: ="Select person for E-CAB"
            Visible: =If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="4") And Dropdown_Category.Selected.CategoryName="Emergency",true,false)
            Width: =212
            X: =35
            Y: =106
            ZIndex: =20

        ComboBox_ECAB_Person_Select As combobox:
            BorderColor: =RGBA(255, 125, 35, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            DefaultSelectedItems: |-
                =If(IsBlank(SelectedCR.CABGroup),Blank(),
                    If(SelectedCR.CABGroup="E-CAB",Blank(),
                        Filter(Filter(ColGroups, CABFlag="Y").GroupName,GroupName=SelectedCR.CABGroup,GroupName)))
            DisplayFields: =["DisplayName","Mail"]
            Height: =28
            HoverFill: =RGBA(253, 222, 207, 1)
            InputTextPlaceholder: ="Search by name"
            Items: |-
                =Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value
            OnSelect: =
            PaddingBottom: =3
            PaddingLeft: =10
            PaddingTop: =3
            PressedFill: =RGBA(253, 222, 207, 1)
            SearchFields: =["Mail"]
            SearchItems: |-
                =Search(Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value,ComboBox_ECAB_Person_Select.SearchText,Mail)
            SelectionFill: =RGBA(250, 155, 112, 1)
            SelectMultiple: =false
            Size: =9
            Visible: =If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="4") And Dropdown_Category.Selected.CategoryName="Emergency",true,false)
            Width: =210
            X: =37
            Y: =137
            ZIndex: =21

        Btn_ECAB_AddPerson As button:
            DisplayMode: =If(IsBlank(ComboBox_ECAB_Person_Select.Selected), DisplayMode.View, DisplayMode.Edit)
            Fill: =RGBA(50, 86, 160, 1)
            Height: =24
            OnSelect: |-
                =Collect(ColTempECAB,
                {Value: Lower(ComboBox_ECAB_Person_Select.Selected.Mail)
                }
                );
                
                Reset(ComboBox_ECAB_Person_Select);
                If(SelectedCR.StageCode="4", Set(VarReassignECAB,true), Set(VarReassignECAB, false));
            Size: =10
            Text: ="Add to e-CAB"
            Visible: =If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="4") And Dropdown_Category.Selected.CategoryName="Emergency",true,false)
            Width: =105
            X: =36
            Y: =177
            ZIndex: =22

        Grp_Btn_ReassignCAB As group:
            Height: =5
            Width: =5
            X: =-238
            Y: =14
            ZIndex: =24

            Btn_ReassignCAB As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update InfoSec information
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify new CAB Group
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       CABGroupAssigned: ComboBox_CABGroup_Select.Selected.GroupName,
                       CurrentHandlerEmail: Concat(ColTempCABMembersUnique, Value, "; " ),
                       FullAuditLog: SelectedCR.FullAuditLog&"Change request re-assigned from "&SelectedCR.CABGroupAssigned& " to "&ComboBox_CABGroup_Select.Selected.GroupName& "by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                       PreviousHandlerGroup:SelectedCR.CABGroupAssigned,
                       PreviousHandlerName: VarUserFullName,
                       PreviousHandlerEmail: Lower(VarUserEmail),
                       SubmitReassignEmailFlag: {Value: "Y"}
                       
                    });
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Re-Assign"
                Visible: =VarReassignCAB
                Width: =90
                X: =85
                Y: =85
                ZIndex: =23

            Icn_ReassignCAB As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: =VarReassignCAB
                Width: =13
                X: =156
                Y: =89
                ZIndex: =25

        Grp_Btn_NotifyECAB As group:
            Height: =5
            Width: =5
            X: =-238
            Y: =14
            ZIndex: =27

            Btn_NotifyECAB As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update E-CAB notification
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail)
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify updated E-CAB Reviewers
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                        CurrentHandlerEmail: Concat(ColTempECAB, Value, "; " ),
                        CABGroupAssigned: "E-CAB",
                        ECABMembers: Concat(ColTempECAB, Value, "; " ),
                        FullAuditLog: SelectedCR.FullAuditLog&"E-CAB members updated by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                        PreviousHandlerName: VarUserFullName,
                        PreviousHandlerEmail: Lower(VarUserEmail),
                        SubmitReassignEmailFlag: {Value: "Y"}    
                    });
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Notify"
                Visible: =VarReassignECAB
                Width: =90
                X: =156
                Y: =178
                ZIndex: =26

            Icn_NotifyECAB As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: =VarReassignECAB
                Width: =13
                X: =222
                Y: =182
                ZIndex: =28

    Container_InfoSec As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =221
        Visible: =If(Rect_InfoSec.Visible, true, false)
        Width: =1297
        X: =38
        Y: =522
        ZIndex: =4

        TextInput_SecurityAssessment As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =If(!IsBlank(SelectedCR.InfoSecRemarks), SelectedCR.InfoSecRemarks, Blank())
            DisplayMode: =If(Value(SelectedCR.StageCode)=3  And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =160
            HintText: ="Evaluate risk impact and provide other remarks"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: |-
                ="Maximum of 60
                 characters"
            Width: =492
            X: =411
            Y: =40
            ZIndex: =4

        Lbl_SecurityAssmt As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |-
                =If(Value(SelectedCR.StageCode)=3 , "Security Assessment  *", "Security Assessment")
                //"Security Assessment  *"
            Width: =282
            X: =406
            Y: =11
            ZIndex: =8

        Lbl_InfoSecGrp As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)=2  Or Value(SelectedCR.StageCode)=3  , "Information Security Reviewer  *", "Information Security Reviewer")
            Width: =240
            X: =46
            Y: =11
            ZIndex: =9

        Lbl_InfoSecBy As label:
            FontWeight: =FontWeight.Semibold
            Height: =27
            Size: =10
            Text: |-
                ="Assessed By:"
            Width: =189
            X: =42
            Y: =104
            ZIndex: =10

        Icn_InfoSec As icon.Person:
            Color: =RGBA(0, 0, 0, 1)
            DisplayMode: =DisplayMode.View
            Height: =26
            Icon: =Icon.Person
            Width: =25
            X: =42
            Y: =137
            ZIndex: =11

        ComboBox_InfoSecGroup As combobox:
            BorderColor: =RGBA(255, 125, 35, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: =//LookUp(ColInfoSecTeam, Default="Y")
            DefaultSelectedItems: |-
                =//LookUp(ColInfoSecTeam, Default="Y")
                If(Dropdown_Category.Selected.CategoryName="Major", Blank(),
                    If(IsBlank(SelectedCR.InfoSecReviewerEmail),LookUp(ColInfoSecTeam, Default="Y"),
                LookUp(ColInfoSecTeam, Lower(InfoSecEmail)=Lower(SelectedCR.InfoSecReviewerEmail))
                ))
            DisplayFields: =["InfoSecName","InfoSecJobTitle"]
            DisplayMode: |-
                =//Editable only if at stage 2 or stage 3, else Disabled
                If(((SelectedCR.StageCode="2" Or SelectedCR.StageCode = "3")  And UpdateFormMode="Edit") Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            Height: =33
            HoverFill: =RGBA(253, 222, 207, 1)
            InputTextPlaceholder: ="Find person"
            IsSearchable: =false
            Items: |
                =ColInfoSecTeam
                //ColInfoSecTeam.InfoSecName
                //["Kam Shun"], InfoSecPerson = ComboBox_ChangeMgrGrp.Selected.Region)
            OnChange: |-
                =If(SelectedCR.StatusCode="300" And (SelectedCR.InfoSecReviewerEmail <> Lower(Lbl_InfoSecName.Tooltip) And !IsBlank(SelectedCR.InfoSecReviewerEmail) And !IsBlank(ComboBox_InfoSecGroup.Selected.InfoSecEmail)), 
                Set(VarReassignIS, true), Set(VarReassignIS, false));
            PaddingBottom: =3
            PaddingLeft: =3
            PaddingRight: =3
            PaddingTop: =3
            PressedFill: =RGBA(253, 222, 207, 1)
            SearchFields: =["InfoSecName"]
            SearchItems: =[]
            SelectionFill: =RGBA(250, 155, 112, 1)
            SelectMultiple: =false
            Size: =9
            Template: =ListItemTemplate.Double
            Width: =240
            X: =46
            Y: =40
            ZIndex: =12

        Lbl_InfoSecName As label:
            Height: =33
            Size: =9
            Text: |-
                =If(Lower(ComboBox_InfoSecGroup.Selected.InfoSecPerson.Email)=Lower(ComboBox_Requestor.Selected.Mail), Blank(),ComboBox_InfoSecGroup.Selected.InfoSecPerson.DisplayName)
                //LookUp(ColInfoSecTeam, Default="Y").InfoSecPerson.DisplayName
            Tooltip: =If(Lower(ComboBox_InfoSecGroup.Selected.InfoSecPerson.Email)=Lower(ComboBox_Requestor.Selected.Mail), Blank(),Lower(ComboBox_InfoSecGroup.Selected.InfoSecPerson.Email))
            X: =68
            Y: =128
            ZIndex: =13

        Lbl_InfoSecTitle As label:
            Height: =18
            Size: =8
            Text: |-
                =//If(IsBlank(VarUserEmail),Blank(),Office365Users.UserProfileV2(VarUserEmail).officeLocation)
                If(Lower(ComboBox_InfoSecGroup.Selected.InfoSecPerson.Email)=Lower(ComboBox_Requestor.Selected.Mail), Blank(),
                ComboBox_InfoSecGroup.Selected.InfoSecPerson.JobTitle)
            Width: =217
            X: =68
            Y: =153
            ZIndex: =14

        Icn_InfoSecAccept As icon.Send:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: |-
                =//DisplayMode.Edit
                If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                DisplayMode.Disabled,DisplayMode.Edit)
            Height: =18
            Icon: =Icon.CheckBadge
            Visible: |-
                =true
                //If(SelectedCR.StatusCode="300",true,false)
            Width: =18
            X: =1049
            Y: =73
            ZIndex: =27

        Lbl_SelectInfoSec_ValidationMsg As label:
            Color: =RGBA(221, 79, 14, 1)
            FontWeight: =FontWeight.Semibold
            Height: =29
            Italic: =true
            Size: =8
            Text: ="Info Sec Reviewer cannot be the same person as Initiator."
            Visible: |-
                =If(Lower(ComboBox_InfoSecGroup.Selected.InfoSecPerson.Email)=Lower(ComboBox_Requestor.Selected.Mail), true, false)
                //Validation message appear if selected InfoSecReviewer is the same as Initiator
            Width: =319
            X: =46
            Y: =75
            ZIndex: =28

        Grp_Btn_ReassignIS As group:
            Height: =5
            Width: =5
            X: =-1122
            Y: =52
            ZIndex: =30

            Btn_ReassignIS As button:
                DisplayMode: |-
                    =If(!(Lower(Lbl_InfoSecName.Tooltip)=Lower(SelectedCR.InfoSecReviewerEmail)),DisplayMode.Edit,DisplayMode.Disabled)
                    //DisplayMode.Edit
                    /*
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                    */
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update InfoSec information
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify new InfoSec Reviewer
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       CurrentHandlerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       FullAuditLog: SelectedCR.FullAuditLog&"Change request assigned to new Information Security Reviewer by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                       PreviousHandlerName: SelectedCR.InfoSecReviewerName,
                       PreviousHandlerEmail: SelectedCR.InfoSecReviewerEmail,
                       SubmitReassignEmailFlag: {Value: "Y"}
                    });
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Re-Assign"
                Visible: =VarReassignIS
                Width: =90
                X: =298
                Y: =46
                ZIndex: =29

            Icn_ReassignIS As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: =VarReassignIS
                Width: =13
                X: =369
                Y: =50
                ZIndex: =31

    Container_RequestDetails As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =221
        Visible: =If(Rect_RequestDetails.Visible, true, false)
        Width: =1297
        X: =38
        Y: =522
        ZIndex: =5

        Lbl_ImpactAnalysis As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |-
                ="Impact Analysis *"
                //If(Value(SelectedCR.StageCode)=1, "Impact Analysis", "Impact Analysis *")
            Tooltip: ="Please elaborate on change impact below, before submitting for approval."
            Width: =198
            X: =420
            Y: =77
            ZIndex: =1

        TextInput_ImpactAnalysis As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =SelectedCR.ImpactAnalysis
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>2 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =100
            HintText: ="Required field - Elaborate on the change impact"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: ="Maximum of 500 characters"
            Width: =334
            X: =417
            Y: =106
            ZIndex: =2

        Lbl_ChangeReason As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: ="Reason for Change / Details  *"
            Width: =282
            X: =25
            Y: =77
            ZIndex: =3

        TextInput_ChangeReason As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =SelectedCR.ReasonforChange
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =100
            HintText: |-
                ="Explain the reason for this change request or provide more details.
                
                Attach supporting documents on the right
                (if any)."
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: ="Maximum of 500 characters"
            Width: =370
            X: =25
            Y: =106
            ZIndex: =4

        Lbl_NeedByDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: ="Need By Date  *"
            Width: =154
            X: =25
            Y: =11
            ZIndex: =5

        DatePicker_NeedByDate As datepicker:
            BorderColor: =RGBA(246, 88, 16, 1)
            DefaultDate: =SelectedCR.NeedByDate
            DisplayMode: =If((Value(SelectedCR.StageCode)<=3 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EndYear: =2030
            Height: =28
            IconBackground: =RGBA(246, 88, 16, 1)
            InputTextPlaceholder: |-
                =Blank()
                //If(IsBlank(Self.SelectedDate), Text(Date(2023,1,1), Self.Format, Self.Language))
            PaddingLeft: =10
            PaddingTop: =5
            Reset: =
            Size: =9
            StartYear: =2023
            Width: =160
            X: =25
            Y: =40
            ZIndex: =6

        Icn_ClearNeedByDate As icon.CancelBadge:
            Color: =RGBA(0, 0, 0, 1)
            Height: =15
            Icon: =Icon.CancelBadge
            OnSelect: =Reset(DatePicker_NeedByDate);
            Visible: =false
            Width: =15
            X: =644
            Y: =47
            ZIndex: =7

        Attachment_Form As form:
            DataSource: =ChangeRequestList
            Height: =210
            Item: =SelectedCR
            Width: =520
            X: =762
            Y: =7
            ZIndex: =8

            Attachments_DataCard As typedDataCard.attachmentsEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="{Attachments}"
                Default: =ThisItem.Attachments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@ChangeRequestList],DataSourceInfo.DisplayName,Attachments)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =195
                Required: =false
                Update: =DataCardValue21.Attachments
                Width: =519
                X: =0
                Y: =0
                ZIndex: =10

                DataCardKey26 As label:
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    Height: =28
                    Size: =10
                    Text: ="Attachments   (Max. 10 files)"
                    Width: =270
                    Wrap: =false
                    X: =9
                    Y: =9
                    ZIndex: =1

                DataCardValue21 As attachments:
                    AddAttachmentText: |-
                        ="Attach file here. Avoid using special charcters (e.g. #, ?, @) in file name."
                    BorderColor: =RGBA(255, 125, 35, 1)
                    DisplayMode: =If((Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord) Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), DisplayMode.Edit, DisplayMode.View)
                    Height: =157
                    IsInDataCard: =true
                    Items: =SelectedCR.Attachments
                    MaxAttachments: =10
                    NoAttachmentsText: ="Upload up to 10 files below (max. 10 MB each)"
                    PaddingBottom: =5
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    PaddingTop: =5
                    Size: =8
                    Tooltip: =Parent.DisplayName
                    Width: =499
                    X: =11
                    Y: =41
                    ZIndex: =2

                ErrorMessage26 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue21.Y + DataCardValue21.Height
                    ZIndex: =3

                StarVisible26 As label:
                    Align: =Align.Center
                    Height: =DataCardKey26.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey26.Y
                    ZIndex: =4

        Lbl_ImpactRiskHdr As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: |-
                ="Potential Impact *"
                //If(Value(SelectedCR.StageCode)=1, "Potential Impact", "Potential Impact *")
            Width: =154
            X: =416
            Y: =11
            ZIndex: =9

        Dropdown_ImpactOption As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(246, 88, 16, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: |-
                =//If blank, set default to Medium
                If(IsBlank(SelectedCR.Impact),"Medium",SelectedCR.Impact)
            DisplayMode: |-
                =If((Value(SelectedCR.StageCode)<=3 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
                //DisplayMode.View
            Height: =28
            Items: =ColImpact.Impact
            SelectionFill: =RGBA(251, 188, 159, 1)
            Size: =9
            Width: =160
            X: =417
            Y: =40
            ZIndex: =10

    Container_RequestNavBar As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =42
        Width: =1297
        X: =38
        Y: =468
        ZIndex: =6

        Grp_Btn_RequestDetails As group:
            Height: =5
            Width: =5
            X: =-50
            Y: =-57
            ZIndex: =6

            Button_RequestDetails As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(77, 77, 77, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverColor: =RGBA(251, 188, 159, 1)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Set(RequestNavBar, "ContainerRequestDetails")
                PressedColor: =RGBA(246, 88, 16, 1)
                PressedFill: =RGBA(0, 0, 0, 0)
                Size: =10
                Text: =If(Value(SelectedCR.StageCode)<=2, "Change Details  *", "Change Details")
                Width: =190
                Y: =8
                ZIndex: =4

            Rect_RequestDetails As rectangle:
                Fill: =RGBA(250, 155, 112, 1)
                Height: =8
                OnSelect: =If(RequestNavBar="ContainerRequestDetails", true, false)
                Visible: =If(RequestNavBar="ContainerRequestDetails", true, false)
                Width: =190
                ZIndex: =5

        Grp_Btn_InfoSec As group:
            Height: =5
            Width: =5
            X: =-50
            Y: =-57
            ZIndex: =9

            Button_InfoSec As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(77, 77, 77, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(Value(SelectedCR.StageCode) < 2 Or Value(SelectedCR.StatusCode) = 904 Or Dropdown_Category.Selected.CategoryName="Major", 
                    DisplayMode.Disabled, DisplayMode.Edit)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverColor: =RGBA(251, 188, 159, 1)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Set(RequestNavBar, "ContainerInfoSec")
                PressedColor: =RGBA(246, 88, 16, 1)
                PressedFill: =RGBA(0, 0, 0, 0)
                Size: =10
                Text: |-
                    =If((Value(SelectedCR.StageCode)=2 Or Value(SelectedCR.StageCode)=3) And Dropdown_Category.Selected.CategoryName<>"Major", 
                    "Information Security  *", 
                    "Information Security")
                Tooltip: ="InfoSec / SOC"
                Width: =190
                X: =386
                Y: =8
                ZIndex: =7

            Rect_InfoSec As rectangle:
                Fill: =RGBA(250, 155, 112, 1)
                Height: =8
                Visible: =If(RequestNavBar="ContainerInfoSec", true, false)
                Width: =190
                X: =386
                ZIndex: =8

        Grp_Btn_CABApprovals As group:
            Height: =5
            Width: =5
            X: =-150
            Y: =1
            ZIndex: =11

            Button_CABApprovals As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(77, 77, 77, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(Value(SelectedCR.StageCode) < 2 Or Value(SelectedCR.StatusCode) = 904 Or Dropdown_Category.Selected.CategoryName="Major", 
                    DisplayMode.Disabled, DisplayMode.Edit)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverColor: =RGBA(251, 188, 159, 1)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: |-
                    =Switch(Dropdown_Category.SelectedText.Value="Emergency",
                    Set(RequestNavBar, "ContainerE-CABApprovals")
                    ,
                    Set(RequestNavBar, "ContainerCABApprovals");
                    );
                    
                    If(!IsBlank(ComboBox_CABGroup_Select.SelectedItems),
                            ClearCollect(ColTempCABMembers, Filter(ITAccountsList, GroupAssignment.Value=ComboBox_CABGroup_Select.Selected.GroupName));
                            ClearCollect(ColTempCABMembersUnique, Distinct(ColTempCABMembers,ITAcctEmail)));
                PressedColor: =RGBA(246, 88, 16, 1)
                PressedFill: =RGBA(0, 0, 0, 0)
                Size: =10
                Text: |-
                    =If((Value(SelectedCR.StageCode)=2 Or Value(SelectedCR.StageCode)=4) And Dropdown_Category.Selected.CategoryName<>"Major" , 
                    "Change Advisory Board  *", 
                    "Change Advisory Board")
                Width: =190
                X: =583
                Y: =9
                ZIndex: =9

            Rect_CABApprovals As rectangle:
                Fill: =RGBA(250, 155, 112, 1)
                Height: =8
                Visible: =If(RequestNavBar="ContainerCABApprovals" Or RequestNavBar="ContainerE-CABApprovals" , true, false)
                Width: =190
                X: =583
                ZIndex: =10

        Grp_Btn_ImplementationPlan As group:
            Height: =5
            Width: =5
            X: =-150
            Y: =1
            ZIndex: =13

            Button_ImplementationPlan As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(77, 77, 77, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(219, 219, 219, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(Value(SelectedCR.StageCode) < 1 Or Value(SelectedCR.StatusCode) = 904 Or Dropdown_Category.Selected.CategoryName="Major", 
                    DisplayMode.Disabled, DisplayMode.Edit)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverColor: =RGBA(251, 188, 159, 1)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Set(RequestNavBar, "ContainerImplementationPlan")
                PressedColor: =RGBA(246, 88, 16, 1)
                PressedFill: =RGBA(0, 0, 0, 0)
                Size: =10
                Text: |-
                    =If((Value(SelectedCR.StageCode)=2 Or Value(SelectedCR.StageCode)>=6 And Value(SelectedCR.StageCode)<9 And Dropdown_Category.Selected.CategoryName<>"Major"),
                    "Implementation  *",
                    "Implementation")
                Width: =190
                X: =192
                Y: =8
                ZIndex: =11

            Rect_ImplementationPlan As rectangle:
                Fill: =RGBA(250, 155, 112, 1)
                Height: =8
                Visible: =If(RequestNavBar="ContainerImplementationPlan", true, false)
                Width: =190
                X: =192
                ZIndex: =12

        Grp_Btn_AuditLog As group:
            Height: =5
            Width: =5
            X: =-523
            Y: =1
            ZIndex: =15

            Button_AuditLog As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(77, 77, 77, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverColor: =RGBA(251, 188, 159, 1)
                HoverFill: =RGBA(0, 0, 0, 0)
                OnSelect: =Set(RequestNavBar, "ContainerAuditLog")
                PressedColor: =RGBA(246, 88, 16, 1)
                PressedFill: =RGBA(0, 0, 0, 0)
                Size: =10
                Text: ="Audit Log"
                Width: =190
                X: =773
                Y: =9
                ZIndex: =13

            Rect_AuditLog As rectangle:
                Fill: =RGBA(250, 155, 112, 1)
                Height: =8
                Visible: =If(RequestNavBar="ContainerAuditLog", true, false)
                Width: =190
                X: =773
                ZIndex: =14

    Container_RequestHeader As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =214
        Width: =1297
        X: =38
        Y: =246
        ZIndex: =7

        Rect_BG_ChangeManager As rectangle:
            Fill: =RGBA(253, 222, 207, 0.4)
            Height: =73
            Visible: =If(Value(SelectedCR.StageCode)>=1 And Value(SelectedCR.StageCode)<=2,true,false)
            Width: =263
            X: =1016
            Y: =6
            ZIndex: =1

        Lbl_Requestor As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: ="Initiator  *"
            Width: =214
            X: =533
            Y: =137
            ZIndex: =2

        Lbl_SysAppOption As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: ="System / Application  *"
            Width: =220
            X: =762
            Y: =6
            ZIndex: =3

        Dropdown_SysAppOption As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(246, 88, 16, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: =SelectedCR.SystemApplication
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.View)
            Height: =28
            Items: =ColSystems.SystemName
            SelectionFill: =RGBA(251, 188, 159, 1)
            Size: =9
            Width: =216
            X: =766
            Y: =35
            ZIndex: =4

        Lbl_ModType As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: ="Modification Type"
            Width: =213
            X: =763
            Y: =74
            ZIndex: =5

        Dropdown_ModType As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(246, 88, 16, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: =SelectedCR.ModificationType
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.View)
            Height: =28
            Items: =ColModType.ModificationType
            SelectionFill: =RGBA(251, 188, 159, 1)
            Size: =9
            Width: =216
            X: =766
            Y: =103
            ZIndex: =6

        Lbl_BSR As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: ="BSR Ref"
            Width: =79
            X: =887
            Y: =137
            ZIndex: =7

        Lbl_ITPM As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: ="ITPM Ref"
            Width: =82
            X: =766
            Y: =138
            ZIndex: =8

        TextInput_BSR As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Default: =SelectedCR.BSR
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.View)
            EnableSpellCheck: =true
            Height: =28
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =7
            PaddingLeft: =10
            RadiusBottomLeft: =1
            RadiusBottomRight: =1
            RadiusTopLeft: =1
            RadiusTopRight: =1
            Size: =9
            Tooltip: ="Maximum of 7 characters"
            Width: =94
            X: =886
            Y: =170
            ZIndex: =9

        TextInput_ITPM As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Default: =SelectedCR.ITPM
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.View)
            EnableSpellCheck: =true
            Height: =27
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =6
            PaddingLeft: =5
            RadiusBottomLeft: =1
            RadiusBottomRight: =1
            RadiusTopLeft: =1
            RadiusTopRight: =1
            Size: =9
            Tooltip: ="Maximum of 6 characters"
            Width: =60
            X: =814
            Y: =170
            ZIndex: =10

        "'Lbl_ITPM-Prefix' As label":
            Height: =23
            Size: =9
            Text: ="ITPM - "
            Width: =50
            X: =768
            Y: =172
            ZIndex: =11

        Lbl_ChangeManager As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Change Manager  *"
            Width: =136
            X: =1042
            Y: =3
            ZIndex: =12

        Icn_Search_ChangeManager As icon.Search:
            AutoDisableOnSelect: =false
            Height: =20
            Icon: =Icon.Search
            OnSelect: =Set(VarContainerChangeManager, true)
            Visible: |-
                =//Select Change Manager box only if Stage 2 or below
                If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), true, false)
            Width: =20
            X: =1024
            Y: =8
            ZIndex: =13

        Lbl_Description As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: ="Description  *"
            Width: =282
            X: =25
            Y: =74
            ZIndex: =14

        TextInput_Description As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =SelectedCR.Description
            DisplayMode: |
                =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =92
            HintText: ="Enter details of this change request and attach supporting documents below (if any)."
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: |-
                ="Maximum of 500
                 characters"
            Width: =480
            X: =25
            Y: =105
            ZIndex: =15

        Lbl_Summary As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: ="Change Request Summary  *"
            Width: =282
            X: =25
            Y: =8
            ZIndex: =16

        TextInput_Summary As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =SelectedCR.Summary
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =28
            HintText: ="Provide a summary for this change request (max. 100 characters)"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =100
            PaddingLeft: =10
            Size: =9
            Tooltip: ="Maximum of 100 characters"
            Width: =480
            X: =25
            Y: =39
            ZIndex: =17

        Dropdown_Category As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(246, 88, 16, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: =SelectedCR.Category
            DisplayMode: |-
                =//Only editable if stage is pending Change Manager to assess and classify CR
                If((SelectedCR.StageCode="2"And UpdateFormMode="Edit") Or ConVar_UnlockRecord,DisplayMode.Edit,DisplayMode.View)
                //Edit
            Height: =28
            Items: =ColCategory.CategoryName
            OnChange: |-
                =//Remember to enable this
                Switch(Dropdown_Category.Selected.CategoryName,
                "Major",
                    Set(RequestNavBar, "ContainerRequestDetails");
                    Reset(ComboBox_CABGroup_Select),
                "Emergency",
                    If(IsBlank(SelectedCR.ECABMembers),
                    Clear(ColTempECAB),
                        If(Dropdown_Category.Selected.CategoryName="Emergency" And !IsBlank(SelectedCR.ECABMembers),
                            Clear(ColTempECAB);
                            ForAll(
                                Split(
                                    SelectedCR.ECABMembers,"; "),
                                Collect(ColTempECAB, TrimEnds(ThisRecord.Value))
                            ))),
                If(!IsBlank(ComboBox_CABGroup_Select.SelectedItems),
                        ClearCollect(ColTempCABMembers, Filter(ITAccountsList, GroupAssignment.Value=ComboBox_CABGroup_Select.Selected.GroupName));
                        ClearCollect(ColTempCABMembersUnique, Distinct(ColTempCABMembers,ITAcctEmail))))
            OnSelect: |-
                =//Remember to enable this
                Switch(Dropdown_Category.Selected.CategoryName,
                "Major",
                    Set(RequestNavBar, "ContainerRequestDetails");
                    Reset(ComboBox_CABGroup_Select),
                "Emergency",
                    If(IsBlank(SelectedCR.ECABMembers),
                    Clear(ColTempECAB),
                        If(Dropdown_Category.Selected.CategoryName="Emergency" And !IsBlank(SelectedCR.ECABMembers),
                            Clear(ColTempECAB);
                            ForAll(
                                Split(
                                    SelectedCR.ECABMembers,"; "),
                                Collect(ColTempECAB, TrimEnds(ThisRecord.Value))
                            ))),
                If(!IsBlank(ComboBox_CABGroup_Select.SelectedItems),
                        ClearCollect(ColTempCABMembers, Filter(ITAccountsList, GroupAssignment.Value=ComboBox_CABGroup_Select.Selected.GroupName));
                        ClearCollect(ColTempCABMembersUnique, Distinct(ColTempCABMembers,ITAcctEmail))))
            SelectionFill: =RGBA(251, 188, 159, 1)
            Size: =9
            Width: =200
            X: =1047
            Y: =105
            ZIndex: =18

        Lbl_Category As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)<2, "Category", "Category  *")
            Width: =125
            X: =1042
            Y: =79
            ZIndex: =19

        Lbl_Status As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: ="Status"
            Width: =159
            X: =533
            Y: =6
            ZIndex: =20

        Lbl_StatusDetail As label:
            Height: =45
            Size: =9
            Text: =LookUp(ColStatus,StatusCode=SelectedCR.StatusCode,StatusName)
            Width: =207
            X: =533
            Y: =29
            ZIndex: =21

        Lbl_ChangeMgrGrp As label:
            Height: =23
            Italic: =true
            Size: =9
            Text: |-
                =//First(Split(SelectedCMGroup, "-")).Value
                //SelectedCMGroup
                If(IsBlank(SelectedCMGroup), SelectedCR.ChangeManagerGroup, SelectedCMGroup)
            Width: =225
            X: =1045
            Y: =56
            ZIndex: =22

        Lbl_ChangeMgrName As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: =If(IsBlank(SelectedCMName), SelectedCR.ChangeManagerName, SelectedCMName)
            Tooltip: =If(IsBlank(SelectedCMEmail), SelectedCR.ChangeManagerEmail, SelectedCMEmail)
            Width: =215
            X: =1045
            Y: =32
            ZIndex: =23

        Grp_Btn_ReassignCM As group:
            Height: =5
            Width: =5
            X: =-80
            Y: =-37
            ZIndex: =25

            Btn_ReassignCM As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update Change Manager information
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify new Change Manager
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       CurrentHandlerEmail: Lower(Lbl_ChangeMgrName.Tooltip),
                       FullAuditLog: SelectedCR.FullAuditLog&"Change request assigned to new Change Manager by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                       PreviousHandlerGroup:SelectedCR.ChangeManagerGroup,
                       PreviousHandlerName: SelectedCR.ChangeManagerName,
                       PreviousHandlerEmail: SelectedCR.ChangeManagerEmail,
                       SubmitReassignEmailFlag: {Value: "Y"}
                    });
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Re-Assign"
                Visible: |-
                    =VarReassignCM
                    //true
                    //If( SelectedCR.StatusCode="200" And (SelectedCR.ChangeManagerEmail <> SelectedCMEmail) And !IsBlank(SelectedCR.ChangeManagerEmail) And !IsBlank(SelectedCMEmail), true, false)
                Width: =90
                X: =1182
                Y: =8
                ZIndex: =24

            Icn_ReassignCM As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: |-
                    =VarReassignCM
                    //true
                    //If( SelectedCR.StatusCode="200" And (SelectedCR.ChangeManagerEmail <> SelectedCMEmail) And !IsBlank(SelectedCR.ChangeManagerEmail) And !IsBlank(SelectedCMEmail), true, false)
                Width: =13
                X: =1253
                Y: =12
                ZIndex: =25

        Lbl_Creator As label:
            FontWeight: =FontWeight.Semibold
            Height: =27
            Size: =10
            Text: ="Creator"
            Width: =117
            X: =531
            Y: =76
            ZIndex: =26

        Lbl_CreatorName As label:
            Height: =30
            Size: =9
            Text: =SelectedCR.CreatorName
            Width: =194
            X: =531
            Y: =100
            ZIndex: =27

        Lbl_CategorySelectionNote As label:
            Align: =Align.Right
            Color: =RGBA(221, 79, 14, 1)
            Italic: =true
            Size: =7
            Text: |-
                ="This CR has been classified as Major.
                It will be referred to IT Steering Committee."
            Visible: |-
                =//true
                //Only if Category drop-down is set to Major
                If(Dropdown_Category.Selected.CategoryName="Major",true,false)
            Width: =212
            X: =1048
            Y: =131
            ZIndex: =28

        Lbl_CA_Ref As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: ="CA Ref"
            Width: =94
            X: =990
            Y: =138
            ZIndex: =29

        TextInput_CA_Ref As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Default: =SelectedCR.CARef
            DisplayMode: =If((Value(SelectedCR.StageCode)<=2 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.View)
            EnableSpellCheck: =true
            Height: =28
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =8
            PaddingLeft: =10
            RadiusBottomLeft: =1
            RadiusBottomRight: =1
            RadiusTopLeft: =1
            RadiusTopRight: =1
            Size: =9
            Tooltip: ="Ticket Reference Number from CA ServiceDesk"
            Width: =94
            X: =990
            Y: =170
            ZIndex: =30

        ComboBox_Requestor As combobox:
            BorderColor: =RGBA(255, 125, 35, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            DefaultSelectedItems: =If(IsBlank(SelectedCR.RequesterEmail),Office365Users.UserProfile(Lower(User().Email)), IfError(Office365Users.UserProfile(Lower(SelectedCR.RequesterEmail)),Blank()))
            DisplayFields: =["DisplayName","Mail"]
            DisplayMode: |-
                =//Read-only after Stage Code > 1
                If((Value(SelectedCR.StageCode)<2 And UpdateFormMode="Edit"), DisplayMode.Edit, DisplayMode.View)
            Height: =28
            HoverFill: =RGBA(253, 222, 207, 1)
            Items: |-
                =//Office365Users.SearchUser({searchTerm:ComboBox_Requestor.SearchText,top:10})
                Filter(Office365Users.SearchUserV2({searchTerm:Self.SearchText,top:10}).value,"@johnsonelectric.com" in ThisRecord.UserPrincipalName)
            PressedFill: =RGBA(253, 222, 207, 1)
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(//Office365Users.SearchUser({searchTerm:ComboBox_Requestor.SearchText,top:10})
                Filter(Office365Users.SearchUserV2({searchTerm:Self.SearchText,top:10}).value,"@johnsonelectric.com" in ThisRecord.UserPrincipalName),ComboBox_Requestor.SearchText,DisplayName)
            SelectionFill: =RGBA(250, 155, 112, 1)
            SelectMultiple: =false
            Size: =9
            Template: =ListItemTemplate.Double
            Tooltip: |-
                =If(IsMatch(Self.Selected.Mail,"@stackpole.com",MatchOptions.Contains),
                    Lower(Self.Selected.UserPrincipalName),
                    Lower(Self.Selected.Mail))
            Visible: =If(IsBlankOrError(ComboBox_Requestor.SelectedItems),false,true)
            Width: =210
            X: =531
            Y: =169
            ZIndex: =31

        Lbl_ComboBox_Requestor As label:
            Height: =30
            Size: =9
            Text: =If(IsBlankOrError(ComboBox_Requestor.SelectedItems),SelectedCR.RequesterName)
            Visible: =If(IsBlankOrError(ComboBox_Requestor.SelectedItems),true,false)
            X: =537
            Y: =168
            ZIndex: =32

    Container_RequestFlow As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =146
        Width: =1297
        X: =38
        Y: =88
        ZIndex: =8

        Lbl_RequestForm_CR_Number As label:
            FontWeight: =FontWeight.Semibold
            Height: =37
            PaddingLeft: =20
            Text: |-
                =If(SelectedCR.StatusCode="100","Create New Change Request "&SelectedCR.Title,
                "Change Request "&SelectedCR.Title)
            Width: =393
            Y: =3
            ZIndex: =1

        Rect_WorkflowIndicator As rectangle:
            Fill: =RGBA(202, 202, 202, 1)
            Height: =1
            Width: =1081
            X: =120
            Y: =92
            ZIndex: =2

        Gal_WorkflowStages As gallery.galleryHorizontal:
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =81
            Items: =ColStages
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplateSize: =130
            Width: =1187
            X: =61
            Y: =54
            ZIndex: =3

            Lbl_WorkflowStage As label:
                Align: =Align.Center
                Color: =If(LookUp(ColStatus, StageCode=VarNewStageCode,StageName)=ThisItem.StageName,RGBA(0, 0, 0, 1),RGBA(149, 149, 149, 1))
                FontWeight: |
                    =If(LookUp(ColStatus, StageCode=VarNewStageCode,StageName)=ThisItem.StageName,FontWeight.Semibold,FontWeight.Normal)
                Height: =33
                LineHeight: =1
                OnSelect: =Select(Parent)
                Size: =8
                Text: =ThisItem.StageName
                VerticalAlign: =VerticalAlign.Top
                Width: =93
                X: =7
                Y: =47
                ZIndex: =1

            Icn_WorkflowStage_Marker As circle:
                Fill: |-
                    =//Current-Orange, Pass-Green, NotYet-Grey
                    If(Value(SelectedCR.StageCode="9"),RGBA(127, 178, 57, 1),
                        If(Value(SelectedCR.StageCode) = Value(LookUp(ColStatus, StageName=ThisItem.StageName,StageCode)), RGBA(250, 155, 112, 1),
                            If(Value(SelectedCR.StageCode) > Value(LookUp(ColStatus, StageName=ThisItem.StageName,StageCode)), RGBA(127, 178, 57, 1),
                            RGBA(149, 149, 149, 1))))
                Height: =15
                OnSelect: =
                Width: =15
                X: =46
                Y: =26
                ZIndex: =2

        Container_ProgressBar_Assignee As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.None
            Height: =51
            Width: =1230
            X: =50
            Y: =54
            ZIndex: =4

            Container_ProgessBar_Assignee_Initiator As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: =If(IsBlank(SelectedCR.RequesterName),VarUserFullName,SelectedCR.RequesterName)
                Tooltip: =If(IsBlank(SelectedCR.RequesterEmail),VarUserEmail,SelectedCR.RequesterEmail)
                Width: =100
                X: =19
                Y: =1
                ZIndex: =1

            Container_ProgessBar_Assignee_CM As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: =If(!IsBlank(SelectedCMName),SelectedCMName,SelectedCR.ChangeManagerName)
                Tooltip: =If(!IsBlank(SelectedCMName),SelectedCMEmail,SelectedCR.ChangeManagerEmail)
                Width: =100
                X: =154
                Y: =1
                ZIndex: =2

            Container_ProgessBar_Assignee_InfoSec As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(!IsBlank(ComboBox_InfoSecGroup.Selected.InfoSecName),ComboBox_InfoSecGroup.Selected.InfoSecName,SelectedCR.InfoSecReviewerName))
                    //SelectedCR.InfoSecReviewerName
                Tooltip: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(!IsBlank(ComboBox_InfoSecGroup.Selected.InfoSecEmail),ComboBox_InfoSecGroup.Selected.InfoSecEmail,SelectedCR.InfoSecReviewerEmail))
                    //SelectedCR.InfoSecReviewerName
                Visible: =If(SelectedCR.StatusCode="100" Or SelectedCR.StatusCode="101",false,true)
                Width: =100
                X: =289
                Y: =1
                ZIndex: =3

            Container_ProgessBar_Assignee_CAB As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(IsBlank(SelectedCR.CABReviewerName),SelectedCR.CABGroupAssigned,SelectedCR.CABReviewerName))
                Tooltip: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(IsBlank(SelectedCR.CABReviewerName),SelectedCR.CABGroupAssigned,SelectedCR.CABReviewerEmail))
                Width: =100
                X: =424
                Y: =1
                ZIndex: =4

            Container_ProgessBar_Assignee_CABReviewed As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(IsBlank(SelectedCR.CABReviewerName),SelectedCR.CABGroupAssigned,SelectedCR.CABReviewerName))
                Tooltip: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(IsBlank(SelectedCR.CABReviewerName),SelectedCR.CABGroupAssigned,SelectedCR.CABReviewerEmail))
                Width: =100
                X: =560
                Y: =1
                ZIndex: =5

            Container_ProgessBar_Assignee_AssignMgr As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: |-
                    =If(SelectedCR.Category="Major","N/A",
                    If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.AssignmentGroupManagerName),"N/A",SelectedCR.AssignmentGroupManagerName))
                Tooltip: |-
                    =If(SelectedCR.Category="Major","",
                    If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.AssignmentGroupManagerEmail),"",SelectedCR.AssignmentGroupManagerEmail))
                Width: =100
                X: =694
                Y: =1
                ZIndex: =6

            Container_ProgessBar_Assignee_Implementer As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: =If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.ChangeImplementationName),"N/A",SelectedCR.ChangeImplementationName)
                Tooltip: =If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.ChangeImplementationEmail),"",SelectedCR.ChangeImplementationEmail)
                Width: =100
                X: =829
                Y: =1
                ZIndex: =7

            Container_ProgessBar_Assignee_Checker As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Height: =28
                Size: =7
                Text: =If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.MakerCheckerName),"N/A",SelectedCR.MakerCheckerName)
                Tooltip: =If(SelectedCR.StageCode="9" And IsBlank(SelectedCR.MakerCheckerEmail),"",SelectedCR.MakerCheckerEmail)
                Width: =100
                X: =964
                Y: =1
                ZIndex: =8

        Grp_Btn_Save As group:
            Height: =5
            Width: =5
            X: =-43
            Y: =-60
            ZIndex: =6

            Btn_NewRequest_Save As button:
                Fill: =RGBA(50, 86, 160, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Save existing record to Main List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ChangeImplementationGroup: Lbl_ChangeImplementorGroup.Text,
                       ChangeImplementationName: Lbl_ChangeImplementorName.Text,
                       ChangeImplementationEmail: Lower(Lbl_ChangeImplementorName.Tooltip),
                       MakerCheckerName: Lbl_MakerCheckerName.Text,
                       MakerCheckerEmail: Lbl_MakerCheckerName.Tooltip,
                       ScheduledStartDate: DatePicker_ScheduledStart.SelectedDate,
                       ScheduledEndDate: DatePicker_ScheduledComplete.SelectedDate,
                       ActualImplementationDate: DatePicker_ActualComplete.SelectedDate,
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text,
                       ImplementationOutcome: Dropdown_ImplementationOutcome.Selected.Value,
                       PostImplementationReviewRemarks: TextInput_ImplementationRemarks.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                    
                    //If Category not Major and not Emergency, patch normal CAB Group Value
                    If(Dropdown_Category.Selected.CategoryName<>"Major" And Dropdown_Category.Selected.CategoryName<>"Emergency",
                        Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        {CABGroupAssigned: ComboBox_CABGroup_Select.Selected.GroupName
                        }
                    ));
                    //If Category is Emergency, patch as E-CAB
                    If(Dropdown_Category.Selected.CategoryName = "Emergency",
                        Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        {CABGroupAssigned: "E-CAB",
                        ECABMembers: Concat(ColTempECAB, Value, "; " )
                        }
                    ));
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =10
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =11
                Text: ="Save"
                Visible: =If(Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or (ConVar_UnlockRecord) And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer), true, false)
                Width: =126
                X: =1016
                Y: =19
                ZIndex: =5

            Icn_Save As icon.Save:
                Color: =RGBA(255, 255, 255, 1)
                Height: =18
                Icon: =Icon.Save
                Visible: =If(Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or (ConVar_UnlockRecord) And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer), true, false)
                Width: =18
                X: =1106
                Y: =24
                ZIndex: =7

        Grp_Btn_Cancel As group:
            Height: =5
            Width: =5
            X: =-43
            Y: =-60
            ZIndex: =7

            Btn_NewRequest_Cancel As button:
                Fill: =RGBA(149, 149, 149, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =10
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =11
                Text: ="Cancel"
                Width: =126
                X: =1154
                Y: =20
                ZIndex: =6

            Icn_Cancel As icon.Cancel:
                Color: =RGBA(255, 255, 255, 1)
                Height: =18
                Icon: =Icon.Cancel
                OnSelect: =Navigate(Scn_Home);
                Width: =18
                X: =1248
                Y: =26
                ZIndex: =8

        Grp_Btn_Submit As group:
            Height: =5
            Width: =5
            X: =-43
            Y: =-60
            ZIndex: =8

            Btn_NewRequest_Submit As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    Switch(SelectedCR.StageCode,
                    "1",
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(TextInput_ImpactAnalysis.Text) Or IsBlank(Dropdown_ImpactOption.Selected)),DisplayMode.Disabled,DisplayMode.Edit),
                    "2", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(TextInput_ImpactAnalysis.Text) Or IsBlank(Dropdown_ImpactOption.Selected) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(Gal_DisplayCABSelection.Selected.Value) Or IsBlank(ComboBox_AssignGrpManager.Selected.Mail) Or IsBlank(TextInput_ImplementationPlan.Text) Or IsBlank(TextInput_BackoutPlan.Text)))),DisplayMode.Disabled,DisplayMode.Edit),
                    "3", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(TextInput_ImplementationPlan.Text) Or IsBlank(TextInput_SecurityAssessment.Text) Or IsBlank(Gal_DisplayCABSelection.Selected.Value) Or IsBlank(ComboBox_AssignGrpManager.Selected.Mail)))),DisplayMode.Disabled,DisplayMode.Edit), 
                    "4", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or IsBlank(TextInput_CABRemarks.Text) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(Gal_DisplayCABSelection.Selected.Value) Or IsBlank(TextInput_ImplementationPlan.Text) Or IsBlank(ComboBox_AssignGrpManager.Selected.Mail)))),DisplayMode.Disabled,DisplayMode.Edit),
                    "6", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or IsBlank(Lbl_ChangeImplementorName.Text) Or IsBlank(Lbl_MakerCheckerName.Text)),DisplayMode.Disabled,DisplayMode.Edit),
                    "7", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or IsBlank(Lbl_ChangeImplementorName.Text) Or IsBlank(Lbl_MakerCheckerName.Text) Or IsBlank(DatePicker_ScheduledStart.SelectedDate) Or IsBlank(DatePicker_ScheduledComplete.SelectedDate) Or IsBlank(DatePicker_ActualComplete.SelectedDate) Or IsBlank(TextInput_ImplementationPlan.Text) Or IsBlank(Dropdown_ImplementationOutcome.Selected.Value)),DisplayMode.Disabled,DisplayMode.Edit)
                    )
                Fill: =RGBA(54, 176, 75, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Save existing record and move to next status
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    //Find the next status code
                    If(Dropdown_Category.Selected.CategoryName="Major" And SelectedCR.StatusCode="200",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode=SelectedCR.StatusCode, NextAction_Accept_Alt)),
                            If(SelectedCR.StatusCode="700" And Dropdown_ImplementationOutcome.Selected.Value="Failed", 
                                Set(NextStatusCode, LookUp(ColStatus,StatusCode=SelectedCR.StatusCode, NextAction_Accept_Alt)),
                                    If(SelectedCR.StatusCode="300" And Dropdown_Category.Selected.CategoryName="Emergency",
                                        Set(NextStatusCode, LookUp(ColStatus,StatusCode=SelectedCR.StatusCode, NextAction_Accept_Alt)),
                    Set(NextStatusCode, LookUp(ColStatus,StatusCode=SelectedCR.StatusCode, NextAction_Accept)))));
                    
                    //Find matching next stage code
                    Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                    
                    //If submitting for InfoSec approval, reset the field for needing implementation input
                    If(NextStageCode="3",
                        Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                            {NeedImplementationInput:""}))
                    );
                    
                    //Patch the data fields
                    Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       StatusCode: NextStatusCode,
                       Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                       StageCode: NextStageCode,
                       StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ChangeImplementationGroup: Lbl_ChangeImplementorGroup.Text,
                       ChangeImplementationName: Lbl_ChangeImplementorName.Text,
                       ChangeImplementationEmail: Lower(Lbl_ChangeImplementorName.Tooltip),
                       MakerCheckerName: Lbl_MakerCheckerName.Text,
                       MakerCheckerEmail: Lbl_MakerCheckerName.Tooltip,
                       ScheduledStartDate: DatePicker_ScheduledStart.SelectedDate,
                       ScheduledEndDate: DatePicker_ScheduledComplete.SelectedDate,
                       ActualImplementationDate: DatePicker_ActualComplete.SelectedDate,
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text,
                       ImplementationOutcome: Dropdown_ImplementationOutcome.Selected.Value,
                       PostImplementationReviewRemarks: TextInput_ImplementationRemarks.Text
                    }));
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        Attachment_Form.Updates);
                    
                    //If Category not Major and not Emergency, patch normal CAB Group Value
                    If(Dropdown_Category.Selected.CategoryName<>"Major" And Dropdown_Category.Selected.CategoryName<>"Emergency",
                        Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {CABGroupAssigned: ComboBox_CABGroup_Select.Selected.GroupName
                        }
                    ));
                    //If Category is Emergency, patch as E-CAB
                    If(Dropdown_Category.Selected.CategoryName = "Emergency",
                        Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {CABGroupAssigned: "E-CAB",
                        ECABMembers: Concat(ColTempECAB, Value, "; " )
                        }
                    ));
                    
                    //Special patching for initial submission - Logged or Re-Submitted after return
                    Switch(NextStatusCode,
                    "101",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode="101", NextAction_Accept));
                        Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                    Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {
                            StatusCode: NextStatusCode,
                            Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                            StageCode: NextStageCode,
                            StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                            FullAuditLog: UpdatedCR.FullAuditLog&"Change request submitted by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                        }));
                        ,
                    "102",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode="101", NextAction_Accept));
                        Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                    Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {
                            StatusCode: NextStatusCode,
                            Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                            StageCode: NextStageCode,
                            StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                            FullAuditLog: UpdatedCR.FullAuditLog&"Change request submitted by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                        }));
                    ""
                    );
                    
                    //Based on new status code - Update current handler, key dates and audit log
                    Switch(UpdatedCR.StatusCode,
                    "200",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(Lbl_ChangeMgrName.Tooltip),
                        SubmittedDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request routed to Change Manager - "&Lbl_ChangeMgrName.Text&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "300",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(Lbl_InfoSecName.Tooltip),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request accepted by Change Manager - "&UpdatedCR.ChangeManagerName&" on "&VarCurrentDateTime&Char(13)&"Change request routed to "&Lbl_InfoSecName.Text&" for InfoSec review on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "401",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Concat(ColTempCABMembersUnique, Value, "; " ),
                        InfoSecOutcome: "Approved",
                        InfoSecResponseDate: Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request accepted by InfoSec reviewer - "&Lbl_InfoSecName.Text&" on "&VarCurrentDateTime&Char(13)&"Change request routed to "&ComboBox_CABGroup_Select.Selected.GroupName&" for CAB approval on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "402",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Concat(ColTempECAB, Value, "; " ),
                        InfoSecOutcome: "Approved",
                        InfoSecResponseDate: Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request accepted by InfoSec reviewer - "&Lbl_InfoSecName.Text&" on "&VarCurrentDateTime&Char(13)&"Change request routed for E-CAB approval on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "501",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(UpdatedCR.AssignmentGroupManagerEmail),
                        CABReviewerName: VarUserFullName,
                        CABReviewerEmail: VarUserEmail,
                        CABReviewerOutcome:"Approved",
                        CABResponseDate:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request approved by "&ComboBox_CABGroup_Select.Selected.GroupName&" - "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)&"Change request routed to Assignment Group Manager -"&UpdatedCR.AssignmentGroupManagerName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "502",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(UpdatedCR.AssignmentGroupManagerEmail),
                        CABReviewerName: VarUserFullName,
                        CABReviewerEmail: VarUserEmail,
                        CABReviewerOutcome:"Approved",
                        CABResponseDate:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request approved by E-CAB: "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)&"Change request routed to Assignment Group Manager -"&UpdatedCR.AssignmentGroupManagerName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "700",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(UpdatedCR.ChangeImplementationEmail),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request assigned by "&VarUserFullName&" to implementator - "&Lbl_ChangeImplementorName.Text&"("&Lbl_ChangeImplementorGroup.Text &") on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "801",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(UpdatedCR.MakerCheckerEmail),
                        ResolveDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request passed implementation by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "802",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: Lower(UpdatedCR.MakerCheckerEmail),
                        ResolveDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request failed implementation by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "901",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request (Implementation Success) reviewed & closed by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "902",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request (Implementation Failed) reviewed & closed by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "904",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request (Major) referred to IT Steering Group by Change Manager - "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "");
                    
                    //Trigger email notification with SubmitEmailFlag
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        SubmitEmailFlag: {Value: "Y"}
                    });
                    
                    //Additional patching & email notification for Assignment Group Manager - After CAB Approval
                    Switch(UpdatedCR.StatusCode,
                    "501",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode="501", NextAction_Accept));
                        Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                        Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {
                            StatusCode: NextStatusCode,
                            Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                            StageCode: NextStageCode,
                            StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                            FullAuditLog: UpdatedCR.FullAuditLog&"Change request pending Assignment Group Manager (" &UpdatedCR.AssignmentGroupManagerName &") to assign implementator on "&VarCurrentDateTime&Char(13),
                            SubmitEmailFlag: {Value: "Y"}
                        }));
                        ,
                    "502",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode="502", NextAction_Accept));
                        Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                    Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {
                            StatusCode: NextStatusCode,
                            Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                            StageCode: NextStageCode,
                            StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                            FullAuditLog: UpdatedCR.FullAuditLog&"Change request pending Assignment Group Manager (" &UpdatedCR.AssignmentGroupManagerName &") to assign implementator on "&VarCurrentDateTime&Char(13),
                            SubmitEmailFlag: {Value: "Y"}
                        }));
                    ,""
                    );
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =20
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =11
                Text: |-
                    =//Stage 3 or 4, change to Approve button
                    Switch(SelectedCR.StageCode,
                    "3","Accept",
                    "4","Approve",
                    "Submit")
                Visible: |-
                    =If(Value(SelectedCR.StageCode)=4 And (SelectedCR.RequesterEmail = VarUserEmail Or SelectedCR.ChangeManagerEmail = VarUserEmail),false,
                        If(Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer), true, false))
                Width: =126
                X: =869
                Y: =19
                ZIndex: =9

            Icn_Submit As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =18
                Icon: =Icon.Send
                Visible: |-
                    =If(Value(SelectedCR.StageCode)=4 And (SelectedCR.RequesterEmail = VarUserEmail Or SelectedCR.ChangeManagerEmail = VarUserEmail),false,
                        If(Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer), true, false))
                Width: =18
                X: =969
                Y: =25
                ZIndex: =10

        Grp_Btn_ReturnCR As group:
            Height: =5
            Width: =5
            X: =-801
            Y: =21
            ZIndex: =11

            Btn_ReturnCR As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    Switch(SelectedCR.StageCode,
                    "3", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(TextInput_SecurityAssessment.Text)))),DisplayMode.Disabled,DisplayMode.Edit), 
                    "4", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or IsBlank(TextInput_CABRemarks.Text) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(Gal_DisplayCABSelection.Selected.Value)))),DisplayMode.Disabled,DisplayMode.Edit),
                    DisplayMode.Disabled)
                Fill: =RGBA(167, 182, 203, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Save existing record and move to next status
                    Set(
                        VarCurrentDateTime,
                        Text(
                            Now(),
                            "mm/dd/yyyy hh:mm:ss"
                        )
                    );
                    //Find the Return status code
                    Switch(
                        SelectedCR.StageCode,
                        "2",
                        Set(
                            NextStatusCode,
                            LookUp(
                                ColStatus,
                                StatusCode = SelectedCR.StatusCode,
                                NextAction_Return
                            )
                        ),
                        "3",
                        Set(
                            NextStatusCode,
                            LookUp(
                                ColStatus,
                                StatusCode = SelectedCR.StatusCode,
                                NextAction_Return
                            )
                        ),
                        "4",
                        Set(
                            NextStatusCode,
                            LookUp(
                                ColStatus,
                                StatusCode = SelectedCR.StatusCode,
                                NextAction_Return
                            )
                        ),
                        "7",
                        Set(
                            NextStatusCode,
                            LookUp(
                                ColStatus,
                                StatusCode = SelectedCR.StatusCode,
                                NextAction_Return
                            )
                        ),
                        Set(
                            NextStatusCode,
                            Blank()
                        )
                    );
                    //Find matching next stage code
                    If(
                        !IsBlank(NextStatusCode),
                        Set(
                            NextStageCode,
                            LookUp(
                                ColStatus,
                                StatusCode = NextStatusCode,
                                StageCode
                            )
                        )
                    );
                    //Patch the data fields
                    If(
                        !IsBlank(NextStatusCode),
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = SelectedCR.Title
                                ),
                                {
                                    StatusCode: NextStatusCode,
                                    Status: LookUp(
                                        ColStatus,
                                        StatusCode = NextStatusCode,
                                        StatusName
                                    ),
                                    StageCode: NextStageCode,
                                    StageName: LookUp(
                                        ColStatus,
                                        StageCode = NextStageCode,
                                        StageName
                                    ),
                                    Summary: TextInput_Summary.Text,
                                    Description: TextInput_Description.Text,
                                    RequesterName: ComboBox_Requestor.Selected.DisplayName,
                                    RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                                    ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                                    ChangeManagerName: Lbl_ChangeMgrName.Text,
                                    ChangeManagerEmail: Lower(Lbl_ChangeMgrName.Tooltip),
                                    Category: Dropdown_Category.Selected.CategoryName,
                                    SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                                    ModificationType: Dropdown_ModType.Selected.ModificationType,
                                    BSR: TextInput_BSR.Text,
                                    ITPM: TextInput_ITPM.Text,
                                    CARef: TextInput_CA_Ref.Text,
                                    ReasonforChange: TextInput_ChangeReason.Text,
                                    NeedByDate: DatePicker_NeedByDate.SelectedDate,
                                    Impact: Dropdown_ImpactOption.Selected.Impact,
                                    InfoSecReviewerName: Lbl_InfoSecName.Text,
                                    InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                                    InfoSecRemarks: TextInput_SecurityAssessment.Text,
                                    CABReviewerRemarks: TextInput_CABRemarks.Text,
                                    AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                                    AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                                    ChangeImplementationGroup: Lbl_ChangeImplementorGroup.Text,
                                    ChangeImplementationName: Lbl_ChangeImplementorName.Text,
                                    ChangeImplementationEmail: Lower(Lbl_ChangeImplementorName.Tooltip),
                                    MakerCheckerName: Lbl_MakerCheckerName.Text,
                                    MakerCheckerEmail: Lbl_MakerCheckerName.Tooltip,
                                    ScheduledStartDate: DatePicker_ScheduledStart.SelectedDate,
                                    ScheduledEndDate: DatePicker_ScheduledComplete.SelectedDate,
                                    ActualImplementationDate: DatePicker_ActualComplete.SelectedDate,
                                    ImplementationDetails: TextInput_ImplementationPlan.Text,
                                    BackOutPlan: TextInput_BackoutPlan.Text,
                                    ImplementationOutcome: Dropdown_ImplementationOutcome.Selected.Value,
                                    PostImplementationReviewRemarks: TextInput_ImplementationRemarks.Text
                                }
                            )
                        )
                    );
                    //Update Attachment field to SP List
                    Patch(
                        ChangeRequestList,
                        LookUp(
                            ChangeRequestList,
                            Title = UpdatedCR.Title
                        ),
                        Attachment_Form.Updates
                    );
                    //Special patching for Return based on current status code
                    Switch(
                        SelectedCR.StatusCode,
                        "200",
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = UpdatedCR.Title
                                ),
                                {
                                    CurrentHandlerEmail: Lower(ComboBox_Requestor.Selected.Mail),
                                    FullAuditLog: UpdatedCR.FullAuditLog & "Change request returned to Initiator by Change Manager - " & VarUserFullName & " on " & VarCurrentDateTime & Char(13)
                                }
                            )
                        );
                        ,
                        "300",
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = UpdatedCR.Title
                                ),
                                {
                                    CurrentHandlerEmail: Lower(ComboBox_Requestor.Selected.Mail),
                                    FullAuditLog: UpdatedCR.FullAuditLog & "Change request returned to Initiator by InfoSec Reviewer - " & VarUserFullName & " on " & VarCurrentDateTime & Char(13)
                                }
                            )
                        );
                        ,
                        "401",
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = UpdatedCR.Title
                                ),
                                {
                                    CurrentHandlerEmail: Lower(ComboBox_Requestor.Selected.Mail),
                                    CABReviewerName: VarUserFullName,
                                    CABReviewerEmail: VarUserEmail,
                                    CABReviewerOutcome: "Returned",
                                    CABResponseDate: Now(),
                                    FullAuditLog: UpdatedCR.FullAuditLog & "Change request returned to Initiator by CAB - " & ComboBox_CABGroup_Select.Selected.GroupName & " - " & VarUserFullName & " on " & VarCurrentDateTime & Char(13)
                                }
                            )
                        );
                        ,
                        "402",
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = UpdatedCR.Title
                                ),
                                {
                                    CurrentHandlerEmail: Lower(ComboBox_Requestor.Selected.Mail),
                                    CABReviewerName: VarUserFullName,
                                    CABReviewerEmail: VarUserEmail,
                                    CABReviewerOutcome: "Returned",
                                    CABResponseDate: Now(),
                                    FullAuditLog: UpdatedCR.FullAuditLog & "Change request returned to Initiator by E-CAB: " & VarUserFullName & " on " & VarCurrentDateTime & Char(13)
                                }
                            )
                        );
                        ,
                        "700",
                        Set(
                            UpdatedCR,
                            Patch(
                                ChangeRequestList,
                                LookUp(
                                    ChangeRequestList,
                                    Title = UpdatedCR.Title
                                ),
                                {
                                    CurrentHandlerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                                    FullAuditLog: UpdatedCR.FullAuditLog & "Change request returned to Assignment Group Manager by Implementer - " & VarUserFullName & " on " & VarCurrentDateTime & Char(13),
                                    ImplementationOutcome: Blank()
                                }
                            )
                        );
                        ,
                        ""
                    );
                    //Trigger return email notification with previous status code
                    If(
                        UpdatedCR.StatusCode = "102" Or UpdatedCR.StatusCode = "600",
                        Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        {
                        SubmitReturnEmailFlag: {Value: "Y"},
                        PreviousStatusCode: SelectedCR.StatusCode
                        });
                        ""
                    );
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingLeft: =0
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =11
                Text: ="Return CR"
                Tooltip: |-
                    =Switch(SelectedCR.StageCode,
                    "2","Return CR to Change Initiator",
                    "4","Return CR to Change Initiator",
                    "7","Return CR to Assignement Group Manager",
                    "Return CR to Change Initiator")
                Visible: =If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="3" Or SelectedCR.StageCode="4" Or SelectedCR.StageCode="7") And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer),true,false)
                Width: =126
                X: =573
                Y: =18
                ZIndex: =11

            Icn_ReturnCR As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                Height: =18
                Icon: =Icon.Reset
                Tooltip: ="Return CR to Change Initiator"
                Visible: =If((SelectedCR.StageCode="2" Or SelectedCR.StageCode="3" Or SelectedCR.StageCode="4" Or SelectedCR.StageCode="7") And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB) And !(VarReassignAGM) And !(VarReassignReviewer),true,false)
                Width: =18
                X: =669
                Y: =23
                ZIndex: =12

        Grp_Btn_RejectCR As group:
            Height: =5
            Width: =5
            X: =-670
            Y: =22
            ZIndex: =14

            Btn_RejectCR As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    Switch(SelectedCR.StageCode,
                    "3", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(TextInput_SecurityAssessment.Text)))),DisplayMode.Disabled,DisplayMode.Edit), 
                    "4", 
                        If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate) Or IsBlank(TextInput_ChangeReason.Text) Or IsBlank(Lbl_ChangeMgrName.Text) Or IsBlank(Dropdown_Category.Selected) Or IsBlank(TextInput_CABRemarks.Text) Or
                        (Dropdown_Category.Selected.CategoryName<>"Major" And (IsBlank(Lbl_InfoSecName.Text) Or IsBlank(Gal_DisplayCABSelection.Selected.Value)))),DisplayMode.Disabled,DisplayMode.Edit),
                    DisplayMode.Disabled)
                Fill: =RGBA(221, 79, 14, 1)
                Height: =28
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Reject CR
                    //Save existing record and move to next status
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    //Find the next status code
                    If(SelectedCR.StageCode="3" Or SelectedCR.StageCode="4",
                        Set(NextStatusCode, LookUp(ColStatus,StatusCode=SelectedCR.StatusCode, NextAction_Reject)),
                            Set(NextStatusCode, Blank()));
                    
                    //Find matching next stage code
                    Set(NextStageCode, LookUp(ColStatus,StatusCode=NextStatusCode, StageCode));
                    
                    //Patch the data fields
                    Set(UpdatedCR,Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       StatusCode: NextStatusCode,
                       Status: LookUp(ColStatus,StatusCode=NextStatusCode, StatusName),
                       StageCode: NextStageCode,
                       StageName: LookUp(ColStatus,StageCode=NextStageCode, StageName),
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text
                    }));
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                        Attachment_Form.Updates);
                    
                    
                    //Reject based on existing status code - Set Current Handler to blank, fill in key dates and audit log
                    Switch(SelectedCR.StatusCode,
                    "300",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        InfoSecOutcome: "Rejected",
                        InfoSecResponseDate: Now(),
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request rejected by InfoSec reviewer - "&Lbl_InfoSecName.Text&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "401",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        CABReviewerName: VarUserFullName,
                        CABReviewerEmail: VarUserEmail,
                        CABReviewerOutcome:"Rejected",
                        CABResponseDate:Now(),
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request rejected by "&ComboBox_CABGroup_Select.Selected.GroupName&" - "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "402",
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        CurrentHandlerEmail: "",
                        CABReviewerName: VarUserFullName,
                        CABReviewerEmail: VarUserEmail,
                        CABReviewerOutcome:"Rejected",
                        CABResponseDate:Now(),
                        CloseDateTime:Now(),
                        FullAuditLog: UpdatedCR.FullAuditLog&"Change request rejected by E-CAB: "&VarUserFullName&" on "&VarCurrentDateTime&Char(13)
                    });
                    ,
                    "");
                    
                    
                    //Trigger email notification with SubmitEmailFlag based on new status code - 903 (CAB) or 905 (InfoSec)
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=UpdatedCR.Title),
                    {
                        SubmitEmailFlag: {Value: "Y"}
                    });
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingLeft: =0
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =11
                Text: ="Reject"
                Tooltip: ="Return CR to Change Initiator"
                Visible: |-
                    =//true
                    If(Value(SelectedCR.StageCode)=4 And (SelectedCR.RequesterEmail = VarUserEmail Or SelectedCR.ChangeManagerEmail = VarUserEmail),false,
                        If(((SelectedCR.StageCode="3" Or SelectedCR.StageCode="4") And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB)) And !(VarReassignAGM) And !(VarReassignReviewer),true,false))
                Width: =126
                X: =724
                Y: =18
                ZIndex: =13

            Icn_RejectCR As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =18
                Icon: =Icon.CancelBadge
                Visible: |-
                    =//true
                    If(Value(SelectedCR.StageCode)=4 And (SelectedCR.RequesterEmail = VarUserEmail Or SelectedCR.ChangeManagerEmail = VarUserEmail),false,
                        If(((SelectedCR.StageCode="3" Or SelectedCR.StageCode="4") And UpdateFormMode="Edit" And !(VarReassignCM) And !(VarReassignIS) And!(VarReassignCAB) And !(VarReassignECAB)) And !(VarReassignAGM) And !(VarReassignReviewer),true,false))
                Width: =18
                X: =814
                Y: =23
                ZIndex: =14

    Container_Form_Header As groupContainer.manualLayoutContainer:
        Fill: =RGBA(253, 222, 207, 1)
        Height: =77
        Width: =1366
        ZIndex: =9

        Form_AppHeader As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Height: =76
            Size: =20
            Text: ="IT Change Request Management"
            Width: =590
            X: =408
            ZIndex: =1

        Form_JE_Logo As image:
            Height: =63
            Image: =JE_Logo
            X: =35
            Y: =6
            ZIndex: =2

        Form_UserImage As image:
            Height: =53
            Image: =VarUserImage
            RadiusBottomLeft: =50
            RadiusBottomRight: =50
            RadiusTopLeft: =50
            RadiusTopRight: =50
            Tooltip: |-
                =Proper(VarUserFullName)&"
                "&VarUserEmail
            Width: =53
            X: =1277
            Y: =11
            ZIndex: =3

    Container_ImplementationPlan As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =221
        Visible: =If(Rect_ImplementationPlan.Visible, true, false)
        Width: =1297
        X: =38
        Y: =524
        ZIndex: =10

        Rect_BG_MakerChecker As rectangle:
            Fill: =RGBA(253, 222, 207, 0.4)
            Height: =57
            Visible: =If(Value(SelectedCR.StageCode)>=6 And Value(SelectedCR.StageCode)<=8,true,false)
            Width: =242
            X: =10
            Y: =150
            ZIndex: =1

        Rect_BG_ChangeImplementor As rectangle:
            Fill: =RGBA(253, 222, 207, 0.4)
            Height: =68
            Visible: =If(Value(SelectedCR.StageCode)>=6 And Value(SelectedCR.StageCode)<=8,true,false)
            Width: =242
            X: =10
            Y: =75
            ZIndex: =2

        Lbl_ImplementationRemarks As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: ="Remarks"
            Width: =282
            X: =996
            Y: =70
            ZIndex: =3

        TextInput_ImplementationPlan As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =If(IsBlank(SelectedCR.ImplementationDetails), Blank(), SelectedCR.ImplementationDetails)
            DisplayMode: =If((Value(SelectedCR.StageCode)>=1 And Value(SelectedCR.StageCode)<4 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord) Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =78
            HintText: ="Provide details for change implementation"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: ="Maximum of 500 characters"
            Width: =386
            X: =591
            Y: =37
            ZIndex: =4

        Lbl_ImplementationPlan As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<=2, "Implementation Plan  *", "Implementation Plan")
            Width: =165
            X: =588
            Y: =6
            ZIndex: =5

        Lbl_ScheduledCompletionDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =32
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<=8, "Scheduled Completion Date  *", "Scheduled Completion Date")
            Width: =203
            X: =372
            Y: =70
            ZIndex: =6

        DatePicker_ScheduledComplete As datepicker:
            BorderColor: =RGBA(246, 88, 16, 1)
            DefaultDate: =If(IsBlank(SelectedCR.ScheduledEndDate), Blank(), SelectedCR.ScheduledEndDate)
            DisplayMode: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            EndYear: =2030
            Height: =30
            IconBackground: =RGBA(246, 88, 16, 1)
            InputTextPlaceholder: |-
                =Blank()
                //If(IsBlank(Self.SelectedDate), Text(Date(2023,1,1), Self.Format, Self.Language))
            PaddingLeft: =10
            PaddingTop: =5
            Size: =9
            StartYear: =2023
            Width: =150
            X: =376
            Y: =104
            ZIndex: =7

        Lbl_BackoutPlan As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<=2, "Backout Plan  *", "Backout Plan")
            Width: =282
            X: =592
            Y: =116
            ZIndex: =8

        TextInput_BackoutPlan As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =If(IsBlank(SelectedCR.BackOutPlan), Blank(), SelectedCR.BackOutPlan)
            DisplayMode: =If((Value(SelectedCR.StageCode)>=1 And Value(SelectedCR.StageCode)<4 And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord) Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =60
            HintText: ="Provide details of backout plan or rollback actions"
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: ="Maximum of 500 characters"
            Width: =385
            X: =592
            Y: =148
            ZIndex: =9

        Lbl_ChangeImplementer As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=6 And Value(SelectedCR.StageCode)<=8, "Change Implementer  *", "Change Implementer")
            Width: =162
            X: =28
            Y: =71
            ZIndex: =10

        Lbl_ImplementationOutcome As label:
            FontWeight: =FontWeight.Semibold
            Height: =29
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<=8, "Implementation Outcome  *", "Implementation Outcome")
            Width: =197
            X: =994
            Y: =6
            ZIndex: =11

        TextInput_ImplementationRemarks As text:
            BorderColor: =RGBA(255, 125, 35, 1)
            Clear: =true
            Default: =If(IsBlank(SelectedCR.PostImplementationReviewRemarks), Blank(), SelectedCR.PostImplementationReviewRemarks)
            DisplayMode: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord), DisplayMode.Edit, DisplayMode.Disabled)
            EnableSpellCheck: =true
            Height: =107
            HintText: |-
                ="Provide post-implementation review remarks.
                Describe the actual change implemented or any follow-up action needed."
            HoverBorderColor: =RGBA(246, 88, 16, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            PaddingLeft: =10
            PaddingTop: =7
            Size: =9
            Tooltip: ="Maximum of 500 characters"
            Width: =280
            X: =1000
            Y: =99
            ZIndex: =12

        Lbl_ActualCompletionDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<=8, "Actual Completion Date  *", "Actual Completion Date")
            Width: =182
            X: =374
            Y: =139
            ZIndex: =13

        DatePicker_ActualComplete As datepicker:
            BorderColor: =RGBA(246, 88, 16, 1)
            DefaultDate: =If(IsBlank(SelectedCR.ActualImplementationDate), Blank(), SelectedCR.ActualImplementationDate)
            DisplayMode: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            EndYear: =2030
            Height: =30
            IconBackground: =RGBA(246, 88, 16, 1)
            InputTextPlaceholder: |-
                =Blank()
                //If(IsBlank(Self.SelectedDate), Text(Date(2023,1,1), Self.Format, Self.Language))
            PaddingLeft: =10
            PaddingTop: =5
            Size: =9
            StartYear: =2023
            Tooltip: =DisplayMode.Edit
            Width: =150
            X: =376
            Y: =170
            ZIndex: =14

        DatePicker_ScheduledStart As datepicker:
            BorderColor: =RGBA(246, 88, 16, 1)
            DefaultDate: =If(IsBlank(SelectedCR.ScheduledStartDate), Blank(), SelectedCR.ScheduledStartDate)
            DisplayMode: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            EndYear: =2030
            Height: =30
            IconBackground: =RGBA(246, 88, 16, 1)
            InputTextPlaceholder: |-
                =Blank()
                //If(IsBlank(Self.SelectedDate), Text(Date(2023,1,1), Self.Format, Self.Language))
            PaddingLeft: =10
            PaddingTop: =5
            Size: =9
            StartYear: =2023
            Width: =150
            X: =376
            Y: =35
            ZIndex: =15

        Lbl_ScheduledStartDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<=8, "Scheduled Start Date  *", "Scheduled Start Date")
            Width: =162
            X: =371
            Y: =6
            ZIndex: =16

        Lbl_MakerCheckerName As label:
            FontWeight: =FontWeight.Semibold
            Height: =27
            Size: =9
            Text: =If(IsBlank(SelectedCheckerName), SelectedCR.MakerCheckerName, SelectedCheckerName)
            Tooltip: =If(IsBlank(SelectedCheckerEmail), SelectedCR.MakerCheckerEmail, SelectedCheckerEmail)
            Width: =220
            X: =35
            Y: =175
            ZIndex: =17

        Lbl_MakerChecker As label:
            FontWeight: =FontWeight.Semibold
            Height: =31
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=6 And Value(SelectedCR.StageCode)<=8, "Maker-Checker  *", "Maker-Checker")
            Width: =162
            X: =30
            Y: =146
            ZIndex: =18

        Lbl_ChangeImplementorGroup As label:
            Height: =21
            Italic: =true
            Size: =7.5
            Text: |-
                =//First(Split(SelectedCMGroup, "-")).Value
                //SelectedCMGroup
                If(IsBlank(SelectedCIGroup), SelectedCR.ChangeImplementationGroup, SelectedCIGroup)
            Width: =215
            X: =35
            Y: =126
            ZIndex: =19

        Lbl_ChangeImplementorName As label:
            FontWeight: =FontWeight.Semibold
            Height: =28
            Size: =10
            Text: =If(IsBlank(SelectedCIName), SelectedCR.ChangeImplementationName, SelectedCIName)
            Tooltip: =If(IsBlank(SelectedCIEmail), SelectedCR.ChangeImplementationEmail, SelectedCIEmail)
            Width: =220
            X: =32
            Y: =97
            ZIndex: =20

        ComboBox_AssignGrpManager As combobox:
            BorderColor: =RGBA(255, 125, 35, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            DefaultSelectedItems: |-
                =If(IsBlankOrError(Office365Users.UserProfile(Lower(SelectedCR.AssignmentGroupManagerEmail))),Blank(),Office365Users.UserProfile(Lower(SelectedCR.AssignmentGroupManagerEmail)))
                //If(IsBlank(SelectedCR.AssignmentGroupManagerEmail),Blank(), Office365Users.UserProfile(Lower(SelectedCR.AssignmentGroupManagerEmail)))
            DisplayFields: =["DisplayName","Mail"]
            DisplayMode: =If(Value(SelectedCR.StageCode)<=6 And Value(SelectedCR.StageCode)>=2 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
            Height: =30
            HoverFill: =RGBA(253, 222, 207, 1)
            InputTextPlaceholder: ="Find name"
            Items: |-
                =//Office365Users.SearchUser({searchTerm:ComboBox_AssignGrpManager.SearchText,top:10})
                //Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value
                Filter(Office365Users.SearchUserV2({searchTerm:Self.SearchText,top:5}).value,"@johnsonelectric.com" in ThisRecord.UserPrincipalName)
            OnChange: |-
                =If(SelectedCR.StatusCode="600" And (SelectedCR.AssignmentGroupManagerEmail <> Lower(ComboBox_AssignGrpManager.Selected.Mail) And !IsBlank(SelectedCR.AssignmentGroupManagerEmail) And !IsBlank(ComboBox_AssignGrpManager.Selected.Mail)), 
                Set(VarReassignAGM, true), Set(VarReassignAGM, false));
            PressedFill: =RGBA(253, 222, 207, 1)
            SearchFields: =["DisplayName"]
            SearchItems: |-
                =Search(//Office365Users.SearchUser({searchTerm:ComboBox_AssignGrpManager.SearchText,top:10})
                //Office365Users.SearchUserV2({searchTerm:Self.SearchText}).value
                Filter(Office365Users.SearchUserV2({searchTerm:Self.SearchText,top:5}).value,"@johnsonelectric.com" in ThisRecord.UserPrincipalName),ComboBox_AssignGrpManager.SearchText,DisplayName)
            SelectionFill: =RGBA(250, 155, 112, 1)
            SelectMultiple: =false
            Size: =9
            Template: =ListItemTemplate.Double
            Width: =220
            X: =31
            Y: =35
            ZIndex: =21

        Lbl_AssignGroupMgr As label:
            FontWeight: =FontWeight.Semibold
            Height: =22
            Size: =10
            Text: =If(Value(SelectedCR.StageCode)>=2,"Assignment Group Manager *","Assignment Group Manager")
            Width: =219
            X: =23
            Y: =10
            ZIndex: =22

        Icn_ClearScheduledStartDate As icon.CancelBadge:
            Color: =RGBA(0, 0, 0, 1)
            Height: =15
            Icon: =Icon.CancelBadge
            OnSelect: =Reset(DatePicker_ScheduledStart);
            Visible: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, true, false)
            Width: =15
            X: =471
            Y: =42
            ZIndex: =23

        Icn_ClearScheduledCompleteDate As icon.CancelBadge:
            Color: =RGBA(0, 0, 0, 1)
            Height: =15
            Icon: =Icon.CancelBadge
            OnSelect: =Reset(DatePicker_ScheduledComplete);
            Visible: =If(Value(SelectedCR.StageCode)>=2 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, true, false)
            Width: =15
            X: =471
            Y: =111
            ZIndex: =24

        Icn_ClearActualCompleteDate As icon.CancelBadge:
            Color: =RGBA(0, 0, 0, 1)
            Height: =15
            Icon: =Icon.CancelBadge
            OnSelect: =Reset(DatePicker_ActualComplete);
            Visible: =If(Value(SelectedCR.StageCode)>=7 And Value(SelectedCR.StageCode)<9 And UpdateFormMode="Edit" Or ConVar_UnlockRecord, true, false)
            Width: =15
            X: =471
            Y: =177
            ZIndex: =25

        Dropdown_ImplementationOutcome As dropdown:
            AllowEmptySelection: =true
            BorderColor: =RGBA(246, 88, 16, 1)
            ChevronBackground: =RGBA(246, 88, 16, 1)
            ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
            Default: =If(IsBlank(SelectedCR.ImplementationOutcome), Blank(), SelectedCR.ImplementationOutcome)
            DisplayMode: |-
                =//Only editable if stage is pending Implementation
                If((SelectedCR.StageCode="7" And UpdateFormMode="Edit") Or (Value(SelectedCR.StageCode)>3 And ConVar_UnlockRecord),DisplayMode.Edit,DisplayMode.View)
                //Edit
            Height: =28
            Items: =["Implemented","Failed"]
            SelectionFill: =RGBA(251, 188, 159, 1)
            Size: =9
            Width: =195
            X: =999
            Y: =35
            ZIndex: =26

        Icn_Search_Implementer As icon.Search:
            AutoDisableOnSelect: =false
            Height: =20
            Icon: =Icon.Search
            OnSelect: =Set(VarContainerChangeImplementer, true)
            Visible: |-
                =//Select Change Implementer only if Stage 1 or 2 or 6 only or during 1 /2 Implementation Inputs needed
                If((Value(SelectedCR.StageCode)=6 Or Value(SelectedCR.StageCode)=1 Or Value(SelectedCR.StageCode)=2) And UpdateFormMode="Edit" Or ConVar_UnlockRecord Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), true, false)
            Width: =20
            X: =11
            Y: =77
            ZIndex: =27

        Icn_Search_MakerChecker As icon.Search:
            AutoDisableOnSelect: =false
            Height: =20
            Icon: =Icon.Search
            OnSelect: =Set(VarContainerMakerChecker, true)
            Visible: |-
                =//Select Checker only if Stage 6 to 8 only
                If((Value(SelectedCR.StageCode)>=6 And (Value(SelectedCR.StageCode)<=8)) And UpdateFormMode="Edit" Or ConVar_UnlockRecord, true, false)
            Width: =20
            X: =12
            Y: =151
            ZIndex: =28

        Grp_Btn_ReassignAGM As group:
            Height: =5
            Width: =5
            X: =-258
            Y: =-6
            ZIndex: =28

            Btn_ReassignAGM As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update Assignment Group Information
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ScheduledStartDate: DatePicker_ScheduledStart.SelectedDate,
                       ScheduledEndDate: DatePicker_ScheduledComplete.SelectedDate,
                       ActualImplementationDate: DatePicker_ActualComplete.SelectedDate,
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text,
                       ImplementationOutcome: Dropdown_ImplementationOutcome.Selected.Value,
                       PostImplementationReviewRemarks: TextInput_ImplementationRemarks.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify new Assignment Group Manager
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       CurrentHandlerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       FullAuditLog: SelectedCR.FullAuditLog&"Change request re-assigned to new Assignment Group Manager - "&ComboBox_AssignGrpManager.Selected.DisplayName& " by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                        PreviousHandlerName: SelectedCR.AssignmentGroupManagerName,
                        PreviousHandlerEmail: SelectedCR.AssignmentGroupManagerEmail,
                        SubmitReassignEmailFlag: {Value: "Y"}
                    });
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Re-Assign"
                Visible: =VarReassignAGM
                Width: =90
                X: =267
                Y: =39
                ZIndex: =29

            Icn_ReassignAGM As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: =VarReassignAGM
                Width: =13
                X: =338
                Y: =43
                ZIndex: =30

        Grp_Btn_ReassignChecker As group:
            Height: =5
            Width: =5
            X: =-227
            Y: =1
            ZIndex: =31

            Btn_ReassignChecker As button:
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Fill: =RGBA(203, 102, 102, 1)
                Height: =21
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: |-
                    =//Patch record and update Implementation Review information
                    //Save existing record to Main List
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       ChangeManagerGroup: Lbl_ChangeMgrGrp.Text,
                       ChangeManagerName: Lbl_ChangeMgrName.Text,
                       ChangeManagerEmail:Lower(Lbl_ChangeMgrName.Tooltip),
                       Category: Dropdown_Category.Selected.CategoryName,
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ModificationType: Dropdown_ModType.Selected.ModificationType,
                       BSR: TextInput_BSR.Text,
                       ITPM: TextInput_ITPM.Text,
                       CARef: TextInput_CA_Ref.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       NeedByDate: DatePicker_NeedByDate.SelectedDate,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       InfoSecReviewerName: Lbl_InfoSecName.Text,
                       InfoSecReviewerEmail: Lower(Lbl_InfoSecName.Tooltip),
                       InfoSecRemarks: TextInput_SecurityAssessment.Text,
                       CABReviewerRemarks: TextInput_CABRemarks.Text,
                       AssignmentGroupManagerName: ComboBox_AssignGrpManager.Selected.DisplayName,
                       AssignmentGroupManagerEmail: Lower(ComboBox_AssignGrpManager.Selected.Mail),
                       ChangeImplementationGroup: Lbl_ChangeImplementorGroup.Text,
                       ChangeImplementationName: Lbl_ChangeImplementorName.Text,
                       ChangeImplementationEmail: Lower(Lbl_ChangeImplementorName.Tooltip),
                       MakerCheckerName: Lbl_MakerCheckerName.Text,
                       MakerCheckerEmail: Lbl_MakerCheckerName.Tooltip,
                       ScheduledStartDate: DatePicker_ScheduledStart.SelectedDate,
                       ScheduledEndDate: DatePicker_ScheduledComplete.SelectedDate,
                       ActualImplementationDate: DatePicker_ActualComplete.SelectedDate,
                       ImplementationDetails: TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text,
                       ImplementationOutcome: Dropdown_ImplementationOutcome.Selected.Value,
                       PostImplementationReviewRemarks: TextInput_ImplementationRemarks.Text
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                        
                    
                    //Notify new MakerChecker
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       CurrentHandlerEmail: Lower(Lbl_MakerCheckerName.Tooltip),
                       FullAuditLog: SelectedCR.FullAuditLog&"Change request assigned to new Reviewer -"&Lbl_MakerCheckerName.Text&" by "&VarUserFullName&" on "&VarCurrentDateTime&Char(13),
                        PreviousHandlerName: SelectedCR.MakerCheckerName,
                        PreviousHandlerEmail: SelectedCR.MakerCheckerEmail,
                        SubmitReassignEmailFlag: {Value: "Y"}
                    });
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    Reset(TextInput_CA_Ref);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(TextInput_ImpactAnalysis);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                PaddingRight: =15
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =9
                Text: ="Re-Assign"
                Visible: |-
                    =//true
                    VarReassignReviewer
                Width: =90
                X: =272
                Y: =179
                ZIndex: =31

            Icn_ReassignChecker As icon.Send:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =//DisplayMode.Edit
                    If((IsBlank(TextInput_Summary.Text) Or IsBlank(TextInput_Description.Text) Or IsBlank(ComboBox_Requestor.Selected) Or IsBlank(Dropdown_SysAppOption.Selected) Or IsBlank(DatePicker_NeedByDate.SelectedDate)),
                    DisplayMode.Disabled,DisplayMode.Edit)
                Height: =13
                Icon: =Icon.Person
                OnSelect: =//Patch record and update Change Manager information
                Visible: |-
                    =true
                    //VarReassignAGM
                Width: =13
                X: =343
                Y: =183
                ZIndex: =32

        Lbl_AssignGrpMgr As label:
            Height: =30
            Size: =9
            Text: =SelectedCR.AssignmentGroupManagerName
            Visible: =If(IsError(Office365Users.UserProfile(Lower(SelectedCR.AssignmentGroupManagerEmail))) And ComboBox_AssignGrpManager.DisplayMode.View ,true,false)
            Width: =186
            X: =31
            Y: =35
            ZIndex: =33

        Grp_Btn_ImplementationInputs As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            Icn_ImplementorInputs As icon.Information:
                Color: =RGBA(246, 88, 16, 1)
                DisplayMode: =DisplayMode.View
                Height: =20
                Icon: =Icon.Information
                Tooltip: |-
                    ="Note for Change Initiator / Manager: 
                    If you are unsure how to fill up the Implementation Plan / Backout Plan, 
                    you can use this button to invite the Change Implementer to contribute inputs to these fields."
                Visible: |-
                    =//Select Change Implementer only if Stage 1 or 2 or 6 only or during 1 /2 Implementation Inputs needed
                    If((SelectedCR.StageCode="1" Or SelectedCR.StageCode="2") And UpdateFormMode="Edit" Or ConVar_UnlockRecord Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), true, false)
                Width: =20
                X: =890
                Y: =10
                ZIndex: =34

            Btn_NotifyImplementor As button:
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =1
                DisplayMode: |-
                    =//Only in Stage 1 or 2 only and Change Implementer is provided
                    If((Value(SelectedCR.StageCode)=1 Or Value(SelectedCR.StageCode)=2) And (!IsBlank(TextInput_Summary.Text) And !IsBlank(Dropdown_SysAppOption.Selected.SystemName) And !IsBlank(ComboBox_Requestor.Selected.DisplayName)) And (UpdateFormMode="Edit" And (!IsBlank(Lbl_ChangeImplementorName.Tooltip) And Lower(Lbl_ChangeImplementorName.Tooltip)<>Lower(VarUserEmail))) Or ConVar_UnlockRecord, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: =RGBA(250, 155, 112, 1)
                Height: =20
                OnSelect: |-
                    =//Patch Change Implementator and Notify ImplementorEmail Flag
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       ChangeImplementationGroup: Lbl_ChangeImplementorGroup.Text,
                       ChangeImplementationName: Lbl_ChangeImplementorName.Text,
                       ChangeImplementationEmail: Lower(Lbl_ChangeImplementorName.Tooltip),
                       NeedImplementationInput: Lower(Lbl_ChangeImplementorName.Tooltip),
                       Summary: TextInput_Summary.Text,
                       Description: TextInput_Description.Text,
                       ReasonforChange: TextInput_ChangeReason.Text,
                       Impact: Dropdown_ImpactOption.Selected.Impact,
                       ImpactAnalysis: TextInput_ImpactAnalysis.Text,
                       RequesterName: ComboBox_Requestor.Selected.DisplayName,
                       RequesterEmail: Lower(ComboBox_Requestor.Selected.Mail),
                       SystemApplication: Dropdown_SysAppOption.Selected.SystemName,
                       ImplementationDetails:TextInput_ImplementationPlan.Text,
                       BackOutPlan: TextInput_BackoutPlan.Text
                    });
                    
                    //Send email to assigned implementator
                    Set(AppURL, LookUp(ConfigGenParam,Title="AppURL",ParamValue)&"?crparam="&SelectedCR.Title);
                    IfError(
                    Office365Outlook.SendEmailV2(Lbl_ChangeImplementorName.Tooltip, "Request implementation details for IT Change Request #"&SelectedCR.Title,
                    "Dear "&Lbl_ChangeImplementorName.Text&",<br><br>
                    Please assist to input the implementation plan and/or backout plan for IT Change Request <a href="&AppURL&">"&SelectedCR.Title&"</a>"&"
                    <br><br>
                    Requestor: "&ComboBox_Requestor.Selected.DisplayName&"<br>
                    Status: "&Lbl_StatusDetail.Text&"<br>
                    System/Application: "&Dropdown_SysAppOption.Selected.SystemName&"<br>
                    Summary: "&TextInput_Summary.Text&"<br><br>
                    Change Implementer: "&Lbl_ChangeImplementorGroup.Text&" - "&Lbl_ChangeImplementorName.Text&"<br>
                    <br><br>Best Regards,<br>
                    "&VarUserFullName
                    ,{Cc: SelectedCR.CreatorEmail&"; "&ComboBox_Requestor.Selected.Mail&"; "&Lbl_ChangeMgrName.Tooltip&"; "&VarUserEmail}),
                        Notify("Failed to send notification email to Change Implementer", NotificationType.Error),
                    //Success message
                    Notify("Email notification sent to Change Implementer", NotificationType.Success);
                    //Patch audit log
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                        FullAuditLog: SelectedCR.FullAuditLog&VarUserFullName&" requested inputs from Change Implementer -"&Lbl_ChangeImplementorName.Text&" on "&VarCurrentDateTime&Char(13)
                    }));
                    
                    Set(VarCurrentDateTime,Blank());
                Size: =7
                Text: ="Notify Implementer"
                Tooltip: =If(IsBlank(Lbl_ChangeImplementorName.Text),"Please select a Change Implementer first.","Email notification will sent to selected Change Implemnenter")
                Visible: |-
                    =//Select Change Implementer only if Stage 1 or 2 or 6 only or during 1 /2 Implementation Inputs needed
                    If((Value(SelectedCR.StageCode)=1 Or Value(SelectedCR.StageCode)=2) And UpdateFormMode="Edit" Or ConVar_UnlockRecord Or (!IsBlank(SelectedCR.NeedImplementationInput) And Lower(VarUserEmail)=Lower(SelectedCR.NeedImplementationInput)), true, false)
                Width: =107
                X: =776
                Y: =10
                ZIndex: =35

            Btn_ImplementationDetails_Submit As button:
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =1
                DisplayMode: |-
                    =//Only in Stage 1 or 2 only and Change Implementer is the logged-in user
                    If((Value(SelectedCR.StageCode)=1 Or Value(SelectedCR.StageCode)=2) And Lower(SelectedCR.NeedImplementationInput)=Lower(VarUserEmail) And !IsBlank(TextInput_ImplementationPlan.Text) And !IsBlank(TextInput_BackoutPlan.Text) And (SelectedCR.ImplementationDetails<>TextInput_ImplementationPlan.Text Or SelectedCR.BackOutPlan<>TextInput_BackoutPlan.Text),DisplayMode.Edit,DisplayMode.Disabled)
                Height: =20
                OnSelect: |-
                    =//Patch Implementation and Backout fields and attachments
                    Set(VarCurrentDateTime, Text(Now(), "mm/dd/yyyy hh:mm:ss"));
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                       ImplementationDetails:TextInput_ImplementationPlan.Text,
                       BackOutPlan:TextInput_BackoutPlan.Text,
                       NeedImplementationInput:""
                    });
                    
                    //Update Attachment field to SP List
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                        Attachment_Form.Updates);
                    
                    
                    //Notify if user adds Implementation Plan or Backout Plan
                    Set(AppURL, LookUp(ConfigGenParam,Title="AppURL",ParamValue)&"?crparam="&SelectedCR.Title);
                    
                    Switch(SelectedCR.StageCode,
                    "1",
                    IfError(
                    Office365Outlook.SendEmailV2(SelectedCR.CreatorEmail&";"&SelectedCR.RequesterEmail, "Updated implementation details for IT Change Request #"&SelectedCR.Title,
                    "Dear "&SelectedCR.RequesterName&",<br><br>"&
                    VarUserFullName&" has updated the implementation plan and/or backout plan for IT Change Request <a href="&AppURL&">"&SelectedCR.Title&"</a>"&"
                    <br>
                    Please review in the system before submission for approval.<br><br>
                    Status: "&Lbl_StatusDetail.Text&"<br>
                    System/Application: "&Dropdown_SysAppOption.Selected.SystemName&"<br>
                    Summary: "&TextInput_Summary.Text&"<br><br>
                    Change Implementer: "&Lbl_ChangeImplementorGroup.Text&" - "&Lbl_ChangeImplementorName.Text&"<br>
                    Implementation Plan: "&TextInput_ImplementationPlan.Text&"<br>
                    Backout Plan: "&TextInput_BackoutPlan.Text&"<br>
                    <br><br>Best Regards,<br>
                    "&VarUserFullName
                    ,{Cc: SelectedCR.ChangeImplementationEmail&"; "&SelectedCR.ChangeManagerEmail&"; "&VarUserEmail}),
                        Notify("Failed to send notification email to Change Requestor / Manager", NotificationType.Error),
                    //Success message
                    Notify("Email notification sent to Change Requestor or Manager", NotificationType.Success);
                    //Patch audit log
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                        FullAuditLog: SelectedCR.FullAuditLog&VarUserFullName&" updated the implementation plan and/or backout plan on "&VarCurrentDateTime&Char(13)
                    })),
                    "2",
                    IfError(
                    Office365Outlook.SendEmailV2(SelectedCR.ChangeManagerEmail, "Updated implementation details for IT Change Request #"&SelectedCR.Title,
                    "Dear "&SelectedCR.ChangeManagerName&",<br><br>"&
                    VarUserFullName&" has updated the implementation plan and/or backout plan for IT Change Request <a href="&AppURL&">"&SelectedCR.Title&"</a>"&"
                    <br>
                    Please review in the system before submission for approval.<br><br>
                    Status: "&Lbl_StatusDetail.Text&"<br>
                    System/Application: "&Dropdown_SysAppOption.Selected.SystemName&"<br>
                    Summary: "&TextInput_Summary.Text&"<br><br>
                    Change Implementer: "&Lbl_ChangeImplementorGroup.Text&" - "&Lbl_ChangeImplementorName.Text&"<br>
                    Implementation Plan: "&TextInput_ImplementationPlan.Text&"<br>
                    Backout Plan: "&TextInput_BackoutPlan.Text&"<br>
                    <br><br>Best Regards,<br>
                    "&VarUserFullName
                    ,{Cc: SelectedCR.ChangeImplementationEmail&"; "&SelectedCR.RequesterEmail&"; "&SelectedCR.CreatorEmail&"; "&VarUserEmail}),
                        Notify("Failed to send notification email to Change Requestor / Manager", NotificationType.Error),
                    //Success message
                    Notify("Email notification sent to Change Requestor or Manager", NotificationType.Success);
                    //Patch audit log
                    Patch(ChangeRequestList, LookUp(ChangeRequestList, Title=SelectedCR.Title),
                    {
                        FullAuditLog: SelectedCR.FullAuditLog&VarUserFullName&" updated the implementation plan and/or backout plan on "&VarCurrentDateTime&Char(13)
                    })));
                    
                    
                    //RESET VARIABLES
                    Set(SelectedCMGroup,Blank());
                    Set(SelectedCMName,Blank());
                    Set(SelectedCMEmail,Blank());
                    Set(SelectedCABGroup, Blank());
                    Set(SelectedImplementationGroup, Blank());
                    Set(SelectedCIGroup, Blank());
                    Set(SelectedCIName, Blank());
                    Set(SelectedCIEmail, Blank());
                    Set(SelectedCheckerName, Blank());
                    Set(SelectedCheckerGroup, Blank());
                    Set(SelectedCheckerEmail, Blank());
                    Set(VarReassignCM, false);
                    Set(VarReassignIS, false);
                    Set(VarReassignCAB, false);
                    Set(VarReassignECAB, false);
                    Set(VarReassignAGM, false);
                    Set(VarReassignReviewer, false);
                    
                    Set(SelectedCR,Blank());
                    Set(VarCurrentDateTime,Blank());
                    
                    Set(UpdatedCR, Blank());
                    Set(NextStatusCode, Blank());
                    Set(NextStageCode, Blank());
                    
                    //CLEAR COLLECTIONS
                    Clear(ColTempCABMembers);
                    Clear(ColTempCABMembersUnique);
                    Clear(ColTempECAB);
                    
                    
                    //Return to home screen
                    Navigate(Scn_Home);
                    Set(UpdateFormMode,Blank());
                    
                    
                    //RESET FORM CONTROLS
                    //Header fields
                    Reset(TextInput_Summary);
                    Reset(TextInput_Description);
                    Reset(ComboBox_Requestor);
                    Reset(Dropdown_Category);
                    Reset(Dropdown_SysAppOption);
                    Reset(Dropdown_ModType);
                    Reset(TextInput_BSR);
                    Reset(TextInput_ITPM);
                    //Change Details fields
                    Reset(TextInput_ChangeReason);
                    Reset(DatePicker_NeedByDate);
                    Reset(Dropdown_ImpactOption);
                    ResetForm(Attachment_Form);
                    //Info Sec Review fields
                    Reset(ComboBox_InfoSecGroup);
                    Reset(TextInput_SecurityAssessment);
                    //CAB Fields
                    Reset(ComboBox_CABGroup_Select);
                    Reset(ComboBox_ECAB_Person_Select);
                    Reset(Gal_DisplayCABSelection);
                    Reset(TextInput_CABRemarks);
                    //Implementation Fields
                    Reset(ComboBox_AssignGrpManager);
                    Reset(DatePicker_ScheduledStart);
                    Reset(DatePicker_ScheduledComplete);
                    Reset(DatePicker_ActualComplete);
                    Reset(TextInput_ImplementationPlan);
                    Reset(TextInput_BackoutPlan);
                    Reset(Dropdown_ImplementationOutcome);
                    Reset(TextInput_ImplementationRemarks);
                Size: =7
                Text: ="Submit"
                Tooltip: ="Submit inputs for implementation and/or backout plan"
                Visible: |-
                    =//Only in Stage 1 or 2 only and Change Implementer is the logged-in user
                    If((Value(SelectedCR.StageCode)=1 Or Value(SelectedCR.StageCode)=2) And Lower(SelectedCR.NeedImplementationInput)=Lower(VarUserEmail),true,false)
                Width: =48
                X: =924
                Y: =10
                ZIndex: =36

    Container_AuditLog As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =221
        Visible: =If(Rect_AuditLog.Visible, true, false)
        Width: =1297
        X: =38
        Y: =524
        ZIndex: =11

        Lbl_LogDetailsValue As label:
            BorderColor: =RGBA(221, 79, 14, 1)
            BorderThickness: =1
            DisplayMode: =DisplayMode.Disabled
            FocusedBorderThickness: =1
            Height: =109
            Overflow: =Overflow.Scroll
            Size: =9
            Text: =SelectedCR.FullAuditLog
            Width: =878
            X: =45
            Y: =91
            ZIndex: =2

        Lbl_LogDetails As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Log Details"
            Width: =155
            X: =42
            Y: =61
            ZIndex: =3

        Lbl_CloseDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.CloseDateTime
            Width: =155
            X: =1095
            Y: =30
            ZIndex: =4

        Lbl_CloseDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Closure Date"
            Width: =155
            X: =1091
            Y: =8
            ZIndex: =5

        Lbl_ResolveDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.ResolveDateTime
            Width: =155
            X: =898
            Y: =33
            ZIndex: =6

        Lbl_ResolveDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Resolved Date"
            Width: =155
            X: =897
            Y: =8
            ZIndex: =7

        Lbl_CABResponseDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.CABResponseDate
            Width: =155
            X: =678
            Y: =29
            ZIndex: =8

        Lbl_CABResponseDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="CAB Response Date"
            Width: =155
            X: =674
            Y: =8
            ZIndex: =9

        Lbl_InfoSecReviewDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.InfoSecResponseDate
            Width: =155
            X: =456
            Y: =30
            ZIndex: =10

        Lbl_InfoSecReviewDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="InfoSec Review Date"
            Width: =155
            X: =452
            Y: =8
            ZIndex: =11

        Lbl_SubmittedDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.SubmittedDateTime
            Width: =155
            X: =239
            Y: =30
            ZIndex: =12

        Lbl_SubmittedDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Submitted Date"
            Width: =155
            X: =238
            Y: =8
            ZIndex: =13

        Lbl_CreatedDateValue As label:
            Height: =30
            Size: =10
            Text: =SelectedCR.StartDateTime
            Width: =155
            X: =40
            Y: =30
            ZIndex: =14

        Lbl_CreatedDate As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =10
            Text: ="Created Date"
            Width: =155
            X: =40
            Y: =8
            ZIndex: =15

    Container_Box_ChangeMgr As groupContainer.manualLayoutContainer:
        Fill: =RGBA(149, 149, 149, 0.75)
        Height: =768
        Visible: =VarContainerChangeManager
        Width: =1366
        ZIndex: =12

        Container_Box_SelectChangeMgr As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =487
            Visible: =VarContainerChangeManager
            X: =426
            Y: =150
            ZIndex: =2

            Rect_Lbl_SelectChangeMgr_Header As rectangle:
                Fill: =RGBA(253, 222, 207, 1)
                Height: =37
                Width: =500
                ZIndex: =1

            "Gal_SelectChangeMgr As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver5.0'":
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(250, 155, 112, 1)
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =253
                Items: |-
                    =Filter(ConfigChangeManagers,Region.Value=ComboBox_ChangeMgrGrp.Selected.Region && ActiveFlag="Y")
                    //If(IsBlank(ComboBox_ChangeMgrGrp.Selected),Blank(),
                    //    Filter(ITAccountsList, GroupAssignment.Value=ComboBox_ChangeMgrGrp.Selected.GroupName))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =60
                Width: =399
                X: =47
                Y: =147
                ZIndex: =1

                Lbl_SelectChangeMgrName As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =18
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =9
                    Text: =ThisItem.ChangeManager.DisplayName
                    VerticalAlign: =VerticalAlign.Top
                    Width: =171
                    X: =36
                    Y: =13
                    ZIndex: =1

                Lbl_SelectChangeMgrEmail As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =20
                    Italic: =true
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =8
                    Text: =ThisItem.Title
                    Width: =252
                    X: =21
                    Y: =26
                    ZIndex: =2

                Separator_SelectChangeMgr As rectangle:
                    Fill: =RGBA(149, 149, 149, 1)
                    Height: =2
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - Self.Height
                    ZIndex: =4

                Rect_Lbl_SelectChangeMgrName As rectangle:
                    Fill: =RGBA(246, 88, 16, 1)
                    Height: =Parent.TemplateHeight - Separator_SelectChangeMgr.Height
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =5

                Lbl_SelectChangeMgrLocation As label:
                    Align: =Align.Right
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =13
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: |-
                        =ThisItem.Region.Value&" - "&If(IsBlank(ThisItem.ChangeManager.Email),Blank(),
                        Office365Users.UserProfileV2(Lower(ThisItem.ChangeManager.Email)).officeLocation)
                    Tooltip: ="Based on O365 profile"
                    Width: =172
                    X: =198
                    Y: =15
                    ZIndex: =6

                Lbl_SelectChangeMgrEmail_2 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =15
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: =Lower(ThisItem.ChangeManager.Email)
                    Tooltip: |-
                        =If(IsMatch(ThisItem.ChangeManager.Email,"@stackpole.com",MatchOptions.Contains),
                            Lower(Office365Users.UserProfileV2(ThisItem.ChangeManager.Email).userPrincipalName),
                            Lower(ThisItem.ChangeManager.Email))
                    Width: =206
                    X: =36
                    Y: =31
                    ZIndex: =7

                Lbl_SelectChangeMgrName_1 As label:
                    Align: =Align.Right
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =15
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =8
                    Text: =ThisItem.Scope
                    VerticalAlign: =VerticalAlign.Top
                    Width: =133
                    X: =237
                    Y: =31
                    ZIndex: =8

                Icon5 As icon.Information:
                    Color: =RGBA(51, 51, 51, 1)
                    DisplayMode: =DisplayMode.View
                    Height: =17
                    Icon: =Icon.Information
                    OnSelect: =Select(Parent)
                    Tooltip: =ThisItem.Description
                    Width: =17
                    X: =12
                    Y: =20
                    ZIndex: =9

            Lbl_SelectChangeMgr_Header As label:
                FontWeight: =FontWeight.Bold
                Height: =21
                Text: ="Select Change Manager"
                Width: =214
                X: =143
                Y: =8
                ZIndex: =2

            ComboBox_ChangeMgrGrp As combobox:
                BorderColor: =RGBA(255, 125, 35, 1)
                ChevronBackground: =RGBA(246, 88, 16, 1)
                ChevronHoverBackground: =ColorFade(RGBA(246, 88, 16, 1), -20%)
                DefaultSelectedItems: |-
                    =//{Value: First(Split(SelectedCMGroup," - ")).Value}
                DisplayFields: =["Region","Mail"]
                Height: =28
                HoverFill: =RGBA(253, 222, 207, 1)
                InputTextPlaceholder: ="Find group"
                IsSearchable: =false
                Items: =ColRegions.Region
                PaddingBottom: =3
                PaddingLeft: =3
                PaddingRight: =3
                PaddingTop: =3
                PressedFill: =RGBA(253, 222, 207, 1)
                SearchFields: =["Region"]
                SearchItems: =[]
                SelectionFill: =RGBA(250, 155, 112, 1)
                SelectMultiple: =false
                Size: =9
                Width: =196
                X: =47
                Y: =76
                ZIndex: =3

            Lbl_SelectChangeMgrGroup As label:
                FontWeight: =FontWeight.Semibold
                Height: =27
                Size: =10
                Text: ="Select Region / Segment *"
                Width: =196
                X: =47
                Y: =47
                ZIndex: =4

            Btn_SelectChangeMgr As button:
                DisplayMode: |-
                    =If(IsBlank(ComboBox_ChangeMgrGrp.Selected) 
                        Or IsBlank(Gal_SelectChangeMgr.Selected)
                        Or Lower(ComboBox_Requestor.Selected.Mail)=Lower(Gal_SelectChangeMgr.Selected.ChangeManager.Email)
                        , DisplayMode.Disabled, DisplayMode.Edit)
                    
                    //Validation rule - Requestor cannot be the same as Change Manager
                Fill: =RGBA(221, 79, 14, 1)
                Height: =28
                OnSelect: |-
                    =//Store selection in variables
                    Set(SelectedCMGroup, ComboBox_ChangeMgrGrp.Selected.Region&" - "&Gal_SelectChangeMgr.Selected.Scope);
                    Set(SelectedCMName, Gal_SelectChangeMgr.Selected.ChangeManager.DisplayName);
                    If(IsMatch(Gal_SelectChangeMgr.Selected.ChangeManager.Email,"@stackpole.com",MatchOptions.Contains),
                        Set(SelectedCMEmail, Lower(Office365Users.UserProfileV2(Gal_SelectChangeMgr.Selected.ChangeManager.Email).userPrincipalName)),
                        Set(SelectedCMEmail, Lower(Gal_SelectChangeMgr.Selected.ChangeManager.Email)));
                    
                    //Close pop-up container
                    Set(VarContainerChangeManager,false);
                    
                    //Check if VarReAssignment-ChangeManager
                    If(SelectedCR.StatusCode="200" And (SelectedCR.ChangeManagerEmail <> SelectedCMEmail) And !IsBlank(SelectedCR.ChangeManagerEmail) And !IsBlank(SelectedCMEmail), 
                    Set(VarReassignCM, true), Set(VarReassignCM, false));
                    
                    //Reset controls
                    Reset(ComboBox_ChangeMgrGrp);
                    Reset(Gal_SelectChangeMgr);
                Size: =12
                Text: ="Select"
                Width: =112
                X: =131
                Y: =438
                ZIndex: =7

            Btn_CancelChangeMgr As button:
                Fill: =RGBA(149, 149, 149, 1)
                Height: =28
                OnSelect: |
                    =//Set variables to blank
                    //Set(SelectedCMGroup, Blank());
                    //Set(SelectedCMName, Blank());
                    //Set(SelectedCMEmail, Blank());
                    
                    Set(VarReassignCM, false);
                    //Close pop-up container
                    Set(VarContainerChangeManager,false);
                    
                    //Reset controls
                    Reset(ComboBox_ChangeMgrGrp);
                    Reset(Gal_SelectChangeMgr);
                Size: =12
                Text: ="Cancel"
                Width: =112
                X: =285
                Y: =438
                ZIndex: =8

            Lbl_SelectChangeMgrGroup_1 As label:
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10
                Text: ="Change Manager (Select One)  *"
                Width: =280
                X: =45
                Y: =114
                ZIndex: =9

            Lbl_SelectChangeImplementer_ValidationMsg_1 As label:
                Color: =RGBA(221, 79, 14, 1)
                FontWeight: =FontWeight.Semibold
                Height: =28
                Italic: =true
                Size: =8
                Text: ="Change Manager cannot be the same person as Initiator."
                Visible: |-
                    =If(Lower(ComboBox_Requestor.Selected.Mail)=Lower(Gal_SelectChangeMgr.Selected.ChangeManager.Email), true, false)
                    //Validation message appear if RequestorEmail is the same as selected Change Manager email
                Width: =399
                X: =47
                Y: =399
                ZIndex: =10

    Container_Box_ChangeImplementer As groupContainer.manualLayoutContainer:
        Fill: =RGBA(149, 149, 149, 0.75)
        Height: =768
        Visible: =VarContainerChangeImplementer
        Width: =1366
        ZIndex: =13

        Container_Box_SelectChangeImplementer As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =487
            Visible: =VarContainerChangeImplementer
            X: =426
            Y: =150
            ZIndex: =2

            Rect_Lbl_SelectChangeImplementer_Hdr As rectangle:
                Fill: =RGBA(253, 222, 207, 1)
                Height: =37
                Width: =500
                ZIndex: =1

            "Gal_SelectChangeImplementer As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver5.0'":
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(250, 155, 112, 1)
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =218
                Items: |-
                    =Filter(ITAccountsList,GroupAssignment.Value=ComboBox_SelectImplementerGrp.Selected.GroupName && ActiveFlag="Y")
                    //    Filter(ITAccountsList, GroupAssignment.Value=ComboBox_ChangeMgrGrp.Selected.GroupName))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =60
                Width: =399
                X: =51
                Y: =176
                ZIndex: =1

                Lbl_SelectChangeImplementerName As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =8
                    Text: =ThisItem.ITAcctName
                    Width: =200
                    X: =60
                    Y: =8
                    ZIndex: =2

                Separator_SelectChangeImplementer As rectangle:
                    Fill: =RGBA(149, 149, 149, 1)
                    Height: =2
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =58
                    ZIndex: =4

                Rect_Lbl_SelectChangeImplementer As rectangle:
                    Fill: =RGBA(246, 88, 16, 1)
                    Height: =Parent.TemplateHeight - Separator_SelectChangeImplementer.Height
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =5

                Lbl_SelectChangeImplementerLocation As label:
                    Align: =Align.Right
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =13
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: |-
                        =If(IsBlank(Lower(ThisItem.ITAcctEmail)),Blank(),
                        Office365Users.UserProfileV2(Lower(ThisItem.ITAcctEmail)).officeLocation)
                    Tooltip: ="Based on O365 profile"
                    X: =230
                    Y: =15
                    ZIndex: =6

                Lbl_SelectChangeImplementerEmail As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =15
                    Italic: =true
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: =Lower(ThisItem.ITAcctEmail)
                    Tooltip: ="Based on O365 profile"
                    Width: =230
                    X: =60
                    Y: =28
                    ZIndex: =7

                Img_SelectChangeImplementer As image:
                    Height: =35
                    Image: |-
                        =If(IsBlank(Lower(ThisItem.ITAcctEmail)),Blank(),
                        Office365Users.UserPhotoV2(Lower(ThisItem.ITAcctEmail)))
                    RadiusBottomLeft: =50
                    RadiusBottomRight: =50
                    RadiusTopLeft: =50
                    RadiusTopRight: =50
                    Tooltip: |-
                        =Proper(VarUserFullName)&"
                        "&VarUserEmail
                    Width: =35
                    X: =14
                    Y: =11
                    ZIndex: =8

            Lbl_ChangeImplementer_Container_Hdr As label:
                FontWeight: =FontWeight.Bold
                Height: =21
                Text: ="Select Change Implementer"
                Width: =250
                X: =125
                Y: =8
                ZIndex: =2

            Lbl_SelectImplementerGrp As label:
                FontWeight: =FontWeight.Semibold
                Height: =29
                Size: =10
                Text: |-
                    ="Select Implementation Group
                    "
                Width: =265
                X: =51
                Y: =47
                ZIndex: =4

            Btn_SelectChangeImplementer As button:
                DisplayMode: |-
                    =If(IsBlank(ComboBox_SelectImplementerGrp.Selected) 
                       Or IsBlank(Gal_SelectChangeImplementer.Selected)
                       Or Lower(Lbl_MakerCheckerName.Tooltip)=Lower(Gal_SelectChangeImplementer.Selected.ITAcctEmail)
                       , DisplayMode.Disabled, DisplayMode.Edit)
                    
                    //Validation Rule - Change Implementer cannot be the same as Maker-Checker
                Fill: =RGBA(221, 79, 14, 1)
                Height: =28
                OnSelect: |-
                    =//Store selection in variables
                    Set(SelectedCIGroup, ComboBox_SelectImplementerGrp.Selected.GroupName);
                    Set(SelectedCIName, Gal_SelectChangeImplementer.Selected.ITAcctName);
                    Set(SelectedCIEmail, Lower(Gal_SelectChangeImplementer.Selected.ITAcctEmail));
                    
                    //Close pop-up container
                    Set(VarContainerChangeImplementer,false);
                    
                    //Reset controls
                    Reset(ComboBox_SelectImplementerGrp);
                    Reset(Gal_SelectChangeImplementer);
                Size: =12
                Text: ="Select"
                Width: =112
                X: =135
                Y: =430
                ZIndex: =7

            Btn_CancelChangeImplementer As button:
                Fill: =RGBA(149, 149, 149, 1)
                Height: =28
                OnSelect: |
                    =//Set variables to blank
                    //Set(SelectedCMGroup, Blank());
                    //Set(SelectedCMName, Blank());
                    //Set(SelectedCMEmail, Blank());
                    
                    //Close pop-up container
                    Set(VarContainerChangeImplementer,false);
                    
                    //Reset controls
                    Reset(ComboBox_SelectImplementerGrp);
                    Reset(Gal_SelectChangeImplementer);
                Size: =12
                Text: ="Cancel"
                Width: =112
                X: =285
                Y: =430
                ZIndex: =8

            Lbl_SelectChangeImplementer As label:
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10
                Text: ="Change Implementer (Select One)  *"
                Width: =280
                X: =51
                Y: =141
                ZIndex: =9

            ComboBox_SelectImplementerGrp As combobox:
                BorderColor: =RGBA(246, 88, 16, 1)
                ChevronBackground: =RGBA(246, 88, 16, 1)
                DefaultSelectedItems: =Blank()
                DisplayFields: =["GroupName"]
                InputTextPlaceholder: ="Search by group name"
                Items: =Filter(ColGroups,ActiveFlag="Y"&& ImplementationFlag="Y").GroupName
                SearchFields: =["GroupName"]
                SearchItems: =Search(Filter(ColGroups,ActiveFlag="Y"&& ImplementationFlag="Y").GroupName,ComboBox_SelectImplementerGrp.SearchText,GroupName)
                SelectionFill: =RGBA(246, 88, 16, 1)
                SelectMultiple: =false
                Size: =10
                Width: =399
                X: =51
                Y: =80
                ZIndex: =10

            Lbl_SelectChangeImplementer_ValidationMsg As label:
                Color: =RGBA(221, 79, 14, 1)
                FontWeight: =FontWeight.Semibold
                Height: =28
                Italic: =true
                Size: =8
                Text: ="Change Implementer cannot be the same person as Maker-Checker."
                Visible: =If(Lower(Lbl_MakerCheckerName.Tooltip)=Lower(Gal_SelectChangeImplementer.Selected.ITAcctEmail), true, false)
                Width: =399
                X: =51
                Y: =394
                ZIndex: =11

    Container_Box_Checker As groupContainer.manualLayoutContainer:
        Fill: =RGBA(149, 149, 149, 0.75)
        Height: =768
        Visible: =VarContainerMakerChecker
        Width: =1366
        ZIndex: =14

        Container_Box_SelectChecker As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =487
            Visible: =VarContainerMakerChecker
            X: =426
            Y: =150
            ZIndex: =2

            Rect_Lbl_SelectChecker_Hdr As rectangle:
                Fill: =RGBA(253, 222, 207, 1)
                Height: =37
                Width: =500
                ZIndex: =1

            "Gal_SelectChecker As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver5.0'":
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(250, 155, 112, 1)
                BorderThickness: =1
                DelayItemLoading: =true
                Height: =218
                Items: |-
                    =Filter(ITAccountsList,GroupAssignment.Value=ComboBox_SelectCheckerGrp.Selected.GroupName && ActiveFlag="Y")
                    //    Filter(ITAccountsList, GroupAssignment.Value=ComboBox_ChangeMgrGrp.Selected.GroupName))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =60
                Width: =399
                X: =51
                Y: =175
                ZIndex: =1

                Lbl_SelectChangeImplementerName_1 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =20
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =8
                    Text: =ThisItem.ITAcctName
                    Width: =200
                    X: =60
                    Y: =8
                    ZIndex: =2

                Separator_SelectChangeImplementer_1 As rectangle:
                    Fill: =RGBA(149, 149, 149, 1)
                    Height: =2
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =58
                    ZIndex: =4

                Rect_Lbl_SelectChangeImplementer_1 As rectangle:
                    Fill: =RGBA(246, 88, 16, 1)
                    Height: =Parent.TemplateHeight - Separator_SelectChangeImplementer_1.Height
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =4
                    ZIndex: =5

                Lbl_SelectChangeImplementerLocation_1 As label:
                    Align: =Align.Right
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =13
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: |-
                        =If(IsBlank(Lower(ThisItem.ITAcctEmail)),Blank(),
                        Office365Users.UserProfileV2(Lower(ThisItem.ITAcctEmail)).officeLocation)
                    Tooltip: ="Based on O365 profile"
                    X: =230
                    Y: =15
                    ZIndex: =6

                Lbl_SelectChangeImplementerEmail_1 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =15
                    Italic: =true
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =7
                    Text: =Lower(ThisItem.ITAcctEmail)
                    Tooltip: ="Based on O365 profile"
                    Width: =230
                    X: =60
                    Y: =28
                    ZIndex: =7

                Img_SelectChangeImplementer_1 As image:
                    Height: =35
                    Image: |-
                        =If(IsBlank(Lower(ThisItem.ITAcctEmail)),Blank(),
                        Office365Users.UserPhotoV2(Lower(ThisItem.ITAcctEmail)))
                    RadiusBottomLeft: =50
                    RadiusBottomRight: =50
                    RadiusTopLeft: =50
                    RadiusTopRight: =50
                    Tooltip: |-
                        =Proper(VarUserFullName)&"
                        "&VarUserEmail
                    Width: =35
                    X: =14
                    Y: =11
                    ZIndex: =8

            Lbl_Checker_Container_Hdr As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =21
                Text: ="Select Maker-Checker"
                Width: =250
                X: =125
                Y: =8
                ZIndex: =2

            Lbl_SelectCheckerGroup As label:
                FontWeight: =FontWeight.Semibold
                Height: =29
                Size: =10
                Text: ="Filter by Group"
                Width: =265
                X: =51
                Y: =47
                ZIndex: =4

            Btn_SelectChecker As button:
                DisplayMode: |-
                    =If(IsBlank(ComboBox_SelectCheckerGrp.Selected) Or 
                        IsBlank(Gal_SelectChecker.Selected) Or 
                        (Lbl_ChangeImplementorName.Tooltip)=Lower(Gal_SelectChecker.Selected.ITAcctEmail), 
                        DisplayMode.Disabled, DisplayMode.Edit)
                    
                    //Validation Rule - Maker-Checker person cannot be same as Change Implementator
                Fill: =RGBA(221, 79, 14, 1)
                Height: =28
                OnSelect: |
                    =//Store selection in variables
                    Set(SelectedCheckerGroup, ComboBox_SelectCheckerGrp.Selected.GroupName);
                    Set(SelectedCheckerName, Gal_SelectChecker.Selected.ITAcctName);
                    Set(SelectedCheckerEmail, Lower(Gal_SelectChecker.Selected.ITAcctEmail));
                    
                    //Close pop-up container
                    Set(VarContainerMakerChecker,false);
                    
                    //Check if VarReAssignment-Reviewer
                    If(SelectedCR.StageCode="8" And (Lower(SelectedCR.MakerCheckerEmail) <> Lower(SelectedCheckerEmail)) And !IsBlank(SelectedCR.MakerCheckerEmail) And !IsBlank(SelectedCheckerEmail), 
                    Set(VarReassignReviewer, true), Set(VarReassignReviewer, false));
                    
                    //Reset controls
                    Reset(ComboBox_SelectCheckerGrp);
                    Reset(Gal_SelectChecker);
                Size: =12
                Text: ="Select"
                Width: =112
                X: =135
                Y: =432
                ZIndex: =7

            Btn_CanceChecker As button:
                Fill: =RGBA(149, 149, 149, 1)
                Height: =28
                OnSelect: |
                    =//Close pop-up container
                    Set(VarContainerMakerChecker,false);
                    
                    //Reset controls
                    Reset(ComboBox_SelectCheckerGrp);
                    Reset(Gal_SelectChecker);
                Size: =12
                Text: ="Cancel"
                Width: =112
                X: =285
                Y: =432
                ZIndex: =8

            Lbl_SelectChecker As label:
                FontWeight: =FontWeight.Semibold
                Height: =33
                Size: =10
                Text: ="Maker-Checker (Select One)  *"
                Width: =280
                X: =51
                Y: =141
                ZIndex: =9

            ComboBox_SelectCheckerGrp As combobox:
                BorderColor: =RGBA(246, 88, 16, 1)
                ChevronBackground: =RGBA(246, 88, 16, 1)
                DefaultSelectedItems: =Blank()
                DisplayFields: =["GroupName"]
                InputTextPlaceholder: ="Search by group name"
                Items: =Filter(ColGroups,ActiveFlag="Y").GroupName
                SearchFields: =["GroupName"]
                SearchItems: =Search(Filter(ColGroups,ActiveFlag="Y").GroupName,ComboBox_SelectCheckerGrp.SearchText,GroupName)
                SelectionFill: =RGBA(246, 88, 16, 1)
                SelectMultiple: =false
                Size: =10
                Width: =399
                X: =51
                Y: =80
                ZIndex: =10

            Lbl_SelectChecker_ValidationMsg As label:
                Color: =RGBA(221, 79, 14, 1)
                FontWeight: =FontWeight.Semibold
                Height: =28
                Italic: =true
                Size: =8
                Text: ="Maker-Checker cannot be the same person as Change Implementer."
                Visible: =If((Lbl_ChangeImplementorName.Tooltip)=Lower(Gal_SelectChecker.Selected.ITAcctEmail), true, false)
                Width: =399
                X: =51
                Y: =393
                ZIndex: =11

    LBL_DEBUG As label:
        Height: =50
        PaddingLeft: =15
        Size: =9
        Text: |-
            =//ConVar_UnlockRecord
            //SelectedCR.StageCode&" - "&SelectedCR.StatusCode&" --VarUserEmail -"&VarUserEmail&" --Is SystemAdmin--"&VarUserSysAdmin
            //Concat(ColTempCABMembersUnique, Value, " ; " )
            //Gal_DisplayCABSelection.Selected.Value
            //ComboBox_AssignGrpManager.Selected.Mail
        Width: =249
        X: =164
        Y: =13
        ZIndex: =15

    Icn_SysAdmin_Lock_Toggle As icon.Lock:
        Color: =RGBA(246, 88, 16, 1)
        Height: =25
        Icon: =If(ConVar_UnlockRecord,Icon.Unlock,Icon.Lock)
        OnSelect: |-
            =If(ConVar_UnlockRecord,
                UpdateContext({ConVar_UnlockRecord: false}),
                    UpdateContext({ConVar_UnlockRecord: true}))
        Tooltip: ="For System Admin to unlock/lock certain fields for editing"
        Visible: =VarUserSysAdmin
        Width: =36
        X: =1222
        Y: =26
        ZIndex: =16

